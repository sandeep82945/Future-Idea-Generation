We introduce a multivariate local-linear estimator for multivariate regression discontinuity designs in which treatment is assigned by crossing a boundary in the space of running variables. The dominant approach uses the Euclidean distance from a boundary point as the scalar running variable; hence, multivariate designs are handled as uni-variate designs. However, the distance running variable is incompatible with the assumption for asymptotic validity. We handle multivariate designs as multivariate. In this study, we develop a novel asymptotic normality for multivariate local-polynomial estimators. Our estimator is asymptotically valid and can capture heterogeneous treatment effects over the boundary. We demonstrate the effectiveness of our estimator through numerical simulations. Our empirical illustration of a Colombian scholarship study reveals a richer heterogeneity (including its absence) of the treatment effect that is hidden in the original estimates. 1 introduction The regression discontinuity (RD) design takes advantage of a particular treatment assignment mechanism that is set by the running variables. 1 An example of such a mechanism is a scholarship that is awarded to applicants whose scores are above a threshold. The eligibility sometimes involves an additional requirement. For example, the applicants’ poverty scores must be below another threshold to be eligible. These RD designs are multivariate in their running variables because a student must exceed a policy boundary in the space of multivariate running variables to be treated. The multivariate RD design may exhibit heterogeneous treatment effects that are aggregated in the standard design. When the design is multivariate, students at different points on the boundary have different incomes and test scores; hence, their treatment effects may be heterogeneous over the boundary. Policymakers may consider modifying the current scholarship program when the effect declines as income or test scores increase. Heterogeneity across boundary points is critical for improved policy guidance. Nevertheless, such a heterogeneity is often dismissed. One popular approach aggregates observations over the boundary to handle multivariate RD designs. For example, Matsudaira (2008) considers the participation in a program based on either a failure in language or math exams. Matsudaira (2008) reduces the multivariate design by aggregating the languagepassing students who are at the boundary of the math exam. This aggregation approach is valid, but loses heterogeneous treatment effects and is not applicable to a non-rectangular boundary. Another popular approach handles heterogeneous treatment effects by constructing a running variable as the Euclidean distance from a boundary point. For example, Black
1See Imbens and Lemieux (2008), Lee and Lemieux (2010), DiNardo and Lee (2011), and Cattaneo et al. (2019,2023) for extensive surveys of RD literature
(1999) computes the closest boundary point for each unit and compares units of the same closest boundary point to achieve the mean effect across the boundary. Keele and Titiunik (2015) propose another approach with the Euclidean distance from a particular boundary point. The distance approach can capture heterogeneous effects at each boundary point, is straightforward to implement, available as Stata and R packages, rdmulti (Cattaneo et al., 2020), and is applicable to a wider range of designs. However, we find that Assumption 1 (a) of Calonico et al. (2014b) is violated when the running variable is the Euclidean distance from a boundary point. Specifically, the value of its density function shrinks to zero as the running variable approaches the boundary point. 2 Consequently, neither approach maintains both flexible interpretation and asymptotic validity simultaneously. In this study, we obtain an asymptotically valid estimator with flexible interpretation. We take multivariate RD designs as multivariate. For this purpose, we develop a novel asymptotic theory of the multivariate local-polynomial estimator with dimension-specific bandwidths. In the simulation studies, our estimator demonstrates favorable performance against the current practices. Furthermore, we apply our estimates to the data of LondoñoVélez et al. (2020b) who study the impact of a Colombian scholarship program on the college attendance rate. In this application, our estimates reveal a new finding regarding the heterogeneity of treatment effects hidden in the original estimates. Specifically, the impact of the tuition program is homogeneous across different poverty levels with the same test scores, however, the impact sharply declines among the poor students with particularly high test scores. Consequently, policymakers may consider expanding the eligibility of the
2The distance approach may remain valid with a different distance measure. For example, an analysis with “the driving or walking distance, or the distance along paved roads” (Cattaneo et al., 2023, p.132) can remain valid. Nevertheless, the natural distance measure is not necessarily available for the other designs such as those in non-geographical studies. program by loosening the income requirement. We contribute to two different strands of literature. First, we contribute to the literature on the local-polynomial estimation. Ruppert and Wand (1994) show the consistency of the multivariate local-polynomial estimator; Masry (1996) later shows the asymptotic normality of the estimator; however, Masry (1996) imposes that the bandwidths are common across dimensions. Frölich and Huber (2019) is a closely related study that considers the multivariate local-linear estimation for covariates adjustment; however, their focus is on the aggregated scalar parameter, and the optimal bandwidth selection for each dimension is not provided. In our simulation results, allowing for heterogeneous bandwidths is critical for the bias correction procedure in the RD estimation. Therefore, our first contribution is theoretically and practically relevant. Second and more importantly, we contribute to the literature on the estimation of treatment effects for RD designs. For a scalar running variable, the local-linear estimation of Calonico et al. (2014b) is the first choice for estimating treatment effects. Its statistical package, rdrobust (Calonico et al., 2014a, Calonico et al., 2017), is the dominant and reliable package for a uni-variate RD design with a large sample. Local-linear estimation is the first choice for the RD estimator for several reasons. However, existing local-linear estimators cannot handle a multivariate running variable as multivariate. Multivariate estimations are available only in a non-kernel procedure such as Imbens and Wager (2019) and Kwon and Kwon (2020) with tuning parameters of the worst-case second derivative instead of the bandwidth. Our local-linear estimator is as intuitive as a scalar-variable RD design, applicable to a variety of designs, and capable of revealing a rich heterogeneity in treatment effects as demonstrated in our empirical illustration. The remainder of the paper is organized as follows. We introduce and motivate our
estimator in Section 2. In Section 3, we evaluate the proposed estimator in a Monte Carlo simulation. We demonstrate the added value of our estimator in an empirical study by Londoño-Vélez et al. (2020b) in Section 4. Finally, we conclude the paper and discuss future challenges in Section 5. 2 methods Consider a multivariate RD design for a student with a pair of test scores (R1, R2). For example, we consider a program that accepts students whose scores exceed their corresponding thresholds (c1, c2). In this program, the eligibility is set by a treatment region T = {(R1, R2) ∈ R2 : R1 ≥ c1, R2 ≥ c2} (Figure 2 (a)). For another example, consider a program that accepts students whose total score exceeds a single threshold c1 + c2. The eligibility is set by another region T = {(R1, R2) ∈ R2 : R1 +R2 ≥ c1 + c2} (Figure 2 (b)). In general, we consider a binary treatment D ∈ {0, 1} and associated pair of potential outcomes {Y (1), Y (0)} such that Y = DY (1)+(1−D)Y (0) for an observed outcome Y ∈ R. We consider a sharp RD design with a vector of running variables R ∈ R ⊆ Rd for some integer d ≥ 1. Specifically, let T be the treatment region, which is an open subset of the support, R. Let T C be the complement of the closure of T . This T C is the control region, and both T and T C have non-zero Lebesgue measures, and D = 1{R ∈ T }. Let (Yi, Di, Ri)i∈{1,...,n} where Ri = (Ri,1, Ri,2) be the i.i.d. sample of (Y,D,R) where R = (R1, R2). Let c be a particular point on the boundary of the closure of T . Our target parameter is θ(c) := limr→c,r∈T E[Y (1)− Y (0)|R = r]− limr→c,r∈T C E[Y (1)− Y (0)|R = r]. In the following section, we focus on the issues in estimating the given identified parameter θ(c). Under the following assumptions (Hahn et al., 2001; Keele and Titiunik, 2015), θ(c) is the average treatment effect (ATE) at each point of the boundary c:
Proposition 2.1. (Keele and Titiunik, 2015, Proposition 1) If E[Y (1)|R = r] and E[Y (0)|R = r] are continuous in r at all points c of the boundary of the closure of T ; P (Di = 1) = 1 for all i such that Ri ∈ T ; P (Di = 1) = 0 for all i such that Ri ∈ T C , then, θ(c) = E[Y (1)− Y (0)|R = c] for all c in the boundary. 2.1 issues in the conventional estimators As described in the Introduction, two estimation strategies are popular for multivariate RD designs. The former aggregation strategy such as Matsudaira (2008) is a single-variate RD design that aggregates students who satisfy all but one requirement for treatment. The aggregation strategy is valid, but has two shortcomings. First, the strategy is limited to a particular assignment mechanism. Second, the aggregation strategy dismisses the treatment effect heterogeneity, which is the important merit of the multivariate designs. We demonstrate this critical merit of our strategy in discovering the heterogeneity in Section 4 with the Londoño-Vélez et al. (2020b) data. In the latter distance strategy, a multivariate running variable is explicitly reduced to a scalar distance measure. A frequent choice is the Euclidean distance from a point or the closest boundary (Keele and Titiunik, 2015). The distance strategy can be easily implemented in most designs. However, its inference is not theoretically guaranteed because Assumption 1 (a) of Calonico et al. (2014b) is violated. Specifically, the density of the distance running variable shrinks to zero as it approaches the boundary when the distance d̃ bounds the Euclidean distance with some constant:
Proposition 2.2. Let d̃(·, ·) be a distance on Rd such that c1∥a − b∥ ≤ d̃(a, b) for any a, b ∈ Rd and some constant c1 > 0. Here ∥a − b∥ is the Euclidean distance between a = (a1, . . . , ad) ′ and b = (b1, . . . , bd) ′. Define Zi = d̃(Ri, c) with c = (0, . . . , 0) ′ and assume that Ri and Zi have density functions f and fZ , respectively. Assume that f and fZ are continuous. Then we have fZ(z) → 0 as z → 0. Proof. By construction of Zi, for z > 0,
∫ z 0 fZ(r)dr =P (Zi ≤ z) = P (d̃(Ri, 0) ≤ z) ≤ P (c1∥Ri∥ ≤ z) = P (∥Ri∥ ≤ z/c1)
= ∫ z/c1 0 t (∫ 2π 0 f(t cos θ, t sin θ)dθ ) dt =
∫ z 0 c−21 r (∫ 2π 0 f(c−11 r cos θ, c −1 1 r sin θ)dθ ) dr
where the last equality uses the change of variable r = c1t. If f is continuous, then we can show that fZ(0) = 0 by using the above inequality. Since fZ is continuous, the statement follows. Remark 2.1. The boundary point value c is set to zero for illustration. The same argument applies in general by normalizing the running variables with respect to the boundary point. The distance d̃ includes the Euclidean norm ∥a−b∥, ℓ∞-norm ∥a−b∥∞ = max1≤j≤d |aj−bj| ≥
(1/d)∥a− b∥, and ℓ1-norm ∥a− b∥1 = ∑ j=1d |aj − bj| ≥ ∥a− b∥. To illustrate the proposition in an example, consider Ri = (R1i, R2i) where R1i and R2i independent each other, and R1i ∼ U [−1, 1] and R2i ∼ U [0, 1]. The distribution function of Zi = ∥Ri∥ is P (Zi ≤ z) = P (R21i +R22i ≤ z2) = (π/4)z2. The half-circle area shrinks to zero at the order of z2 as z approaches the value 0 at the boundary point (0, 0). This property of fZ(z) violates the critical assumption of the valid inference of a scalar RD estimate. Calonico et al. (2014b) assumes that the density fZ(z) is continuous and bounded away from zero (Assumption 1 (a)). Hence, we cannot guarantee the asymptotic normality of the local-linear estimation with Zi. In Online Appendix C, we further show that the kernel density estimation of the distance running variable diminishes to 0 as the bandwidth h → 0. Hence, this issue can be severe with a direct density estimation as in Imbens and Kalyanaraman (2012). Using the rdrobust package avoids the direct density estimation. Nevertheless, the same concern applies to its asymptotic validity. 2.2 our estimator The two dominant approaches suffer from limitations, and we resolve these limitations using a new estimator. Our estimator can capture the heterogeneous treatment effect over the boundary unlike the aggregation strategy; our estimator avoids the issues in its inference unlike the distance strategy. We demonstrate our estimator in a special case of two-dimensional running variables. Consider the following local-linear estimator β̂+(c) = (β̂+0 (c), β̂ + 1 (c), β̂ + 2 (c)) ′
β̂+(c) = arg min (β0,β1,β2)′∈R3 n∑ i=1 (Yi − β0 − β1(Ri,1 − c1)− β2(Ri,2 − c2))2Kh (Ri − c) 1{Ri ∈ T }
where Kh(Ri − c) = K ((Ri,1 − c1)/h1, (Ri,2 − c2)/h2) and each hj is a sequence of positive bandwidths such that hj → 0 as n → ∞. Unlike Masry (1996), we allow h1 ̸= h2 for the asymptotic normality. Later in Section 3, we demonstrate the importance of allowing heterogeneous bandwidths. Similarly, let β̂−(c) be the estimator using 1{Ri ∈ T c} subsample. Our multivariate RD estimator at c is β̂+0 (c)− β̂−0 (c). We consider a random sample. The treated sample is independent of the control sample
and we consider the following nonparametric regression models for each sample:
Yi =m+(Ri) + ε+,i, E[ε+,i|Ri] = 0, i ∈ {1, . . . , n : Ri ∈ T } and Yi =m−(Ri) + ε−,i, E[ε−,i|Ri] = 0, i ∈ {1, . . . , n : Ri ∈ T C}. For the asymptotic normality, we impose the following regularity conditions that are standard in kernel regression estimations. We provide the conditions under its general possible form. In Online Appendix A, we present the general results for pth order localpolynomial estimation with d-dimensional running variables. The general results in the
Online Appendix are the basis of the bias correction procedure of our estimator. In Assumption 2.1, we assume the existence of a continuous density function for the running variable R. Assumption 2.2 is the regularity conditions for a kernel function. We select a particular set of kernel functions for our subsequent analysis. Assumption 2.3 imposes a set of smoothness conditions for the conditional mean functions m and for the conditional moments of residuals εi. Assumption 2.4 specifies the rate of convergence of the vector of bandwidths {h1, . . . , hd} relative to the sample size n.
Assumption 2.1. Let Ur be a neighborhood of r = (r1, . . . , rd) ′ ∈ R.
(a) The vector of random variables Ri has a probability density function f . (b) The density function f is continuous on Ur and f(r) > 0. Assumption 2.2. Let K : Rd → R be a kernel function such that
(a) ∫ K(z)dz = 1. (b) The kernel function K is bounded and there exists a constant CK > 0 such that K is
supported on [−CK , CK ]d.
(c) Define κ (v) 0 :=
∫ Kv(z)dz, κ
(v) j1,...,jM
:= ∫ ∏M
ℓ=1 zjℓK v(z)dz for integer v, and
ž := (1, (z)′1, . . . , (z) ′ p) ′, (z)L =
( L∏
ℓ=1
zjℓ )′ 1≤j1≤···≤jL≤d , 1 ≤ L ≤ p.
The matrix S = ∫ K(z)  1 ž  (1 ž′)dz is non-singular. Assumption 2.3. Let Ur be a neighborhood of r ∈ R.
(a) The mean function m is (p+ 1)-times continuously partial differentiable on Ur and
define ∂j1...jLm(r) := ∂m(r) ∂rj1 ...rjL , 1 ≤ j1, . . . , jL ≤ d, 0 ≤ L ≤ p+ 1. When L = 0, we set ∂j1...jLm(r) = ∂j0m(r) = m(r). (b) The variance function σ2(z) = E[ε2i |Ri = z] is continuous at r.
(c) There exists a constant δ > 0 such that supz∈Ur E[|ε1|2+δ|R1 = z] ≤ U(r) < ∞. Assumption 2.4. As n → ∞,
(a) hj → 0 for 1 ≤ j ≤ d,
(b) nh1 · · ·hd × h2j1 . . . h 2 jp → ∞ for 1 ≤ j1 ≤ · · · ≤ jp ≤ d,
(c) nh1 · · ·hd × h2j1 . . . h 2 jph 2 jp+1 → cj1...jp+1 ∈ [0,∞) for 1 ≤ j1 ≤ · · · ≤ jp+1 ≤ d.
Under these assumptions, we establish the asymptotic normality of β̂+. Theorem 2.1 (Asymptotic normality of local-linear estimators). Under Assumptions 2.1, 2.2, 2.3 and 2.4 for r = c, the mean function m+ with d = 2 and p = 1, the conditional mean residual ε+,i, and the variance function σ 2 +(z) = E[ε 2 +,i|Ri = z], as n → ∞, we have
√ nh1h2 ( H ll ( β̂+(c)−M+(c) ) − S−1B(2,1)M (2,1)+,n (c) ) d→ N ( 0, σ2+(c)
f(c) S−1KS−1
) ,
where
H ll = diag(1, h1, h2) ∈ R3×3,
M+(c) = (m+(c), ∂1m+(c), ∂2m+(c)) ′ ,
M (2,1) +,n (r) =
( ∂11m+(c)
2 h21, ∂12m+(c)h1h2,
∂22m+(c)
2 h22
)′ , and
B(2,1) = ∫  1 ž  (z)′2dz, K = ∫ K2(z)  1 ž  (1 ž′)dz. The result for β̂−(c) holds under the parallel restrictions. From Theorem 2.1, we derive the following asymptotic expansion of the mean-squared
error (MSE) of m̂+(c): for e1 = (1, 0, 0) ′,
e1S−1B(2,1)  ∂11m+(c) h21 2 ∂12m+(c)h1h2
∂22m+(c) h22 2
  2
︸ ︷︷ ︸ Bias term
+ σ2+(c)
nh1h2f(c) e1S −1KS−1e′1︸ ︷︷ ︸ Variance term . We follow the standard bandwidth selection procedure in RD designs to find the pair of (h1, h2) that minimizes the above asymptotic MSE. However, all three coefficients of the three partial derivatives ∂11m+(c), ∂12m+(c) and ∂22m+(c) in the bias term may be non-zero. This general expression is too complex to obtain an analytical formula for the optimal bandwidths. The above expression can be simplified by choosing the kernels as follows:
κ (1,1) 1 = κ (1,1,1) 1,2 = κ (1,2) 1 = κ (1,1,2) 1,2 = κ (1,2,1) 1,2 = 0. (2.1)
Among the product kernels of the form K(z1, z2) = K1(z1)K2(z2), the above restriction amounts to rotate the space so that the boundary becomes either the x or y-axis. Among
the product kernels, the following kernels satisfy the above restrictions:
K1(z) =  (1− |z|)1{|z|≤1} (two-sided triangular kernel),
3 4 (1− z2)1{|z|≤1} (Epanechnikov kernel),
K2(z) = 2(1− |z|)1{0≤z≤1} (one-sided triangular kernel). The same restriction is possible without a product kernel. For example, a cone kernel
K(z1, z2) = 6
π
( 1− √ z21 + z 2 2 ) 1{z21+z22≤1,z2≥0} = 6 π (1− ∥z∥) 1{∥z∥≤1,z2≥0}. where z = (z1, z2) and ∥z∥ = √ z21 + z 2 2 satisfy (2.1). In the subsequent analysis, we assume that K1 is the two-sided triangular kernel and K2 is the one-sided triangular kernel. For example, the design with T = {(R1, R2) ∈ R2 : R1 ≥ c1, R2 ≥ c2} satisfies the restriction (2.1) as is or with a 90 degrees rotation; the design with T = {(R1, R2) ∈ R2 : R1 + R2 ≥ c1 + c2} satisfies the restriction (2.1) with a 45 degrees rotation. Under (2.1), MSE(m̂+(c)), is simplified as follows
{h21 2 ∂11m+(c) ( s̃1κ (2,1) 1 + s̃3κ (2,1,1) 1,2 ) + h22 2 ∂22m+(c) ( s̃1κ (2,1) 2 + s̃3κ (3,1) 2 )}2 + σ2+(c)
f(c)nh1h2 × κ (2) 0 ( κ (2,1) 1 κ (2,1) 2 )2 − 2κ(1,2)2 ( κ (2,1) 1 )2 κ (2,1) 2 κ (1,1) 2 + κ (2,2) 1 ( κ (2,1) 1 κ (1,1) 2 )2 ( κ (1) 0 κ (2,1) 1 κ (2,1) 2 − ( κ (1,1) 2 )2 κ (2,1) 2 )2
where
 s̃1 s̃2
s̃3
 := 1 κ (1) 0 κ (2,1) 1 κ (2,1) 2 − ( κ (1,1) 2 )2 κ (2,1) 2  κ (2,1) 1 κ (2,1) 2 0
−κ(2,1)1 κ (1,1) 2
 = S−1e1. Consequently, the MSE of the estimator m̂+(c)− m̂+(c) is
{ h21 2 (∂11m+(c)− ∂11m−(c)) ( s̃1κ (2,1) 1 + s̃3κ (2,1,1) 1,2 ) +
h22 2 (∂22m+(c)− ∂22m−(c))
( s̃1κ (2,1) 2 + s̃3κ (3,1) 2
)}2
+ (σ2+(c) + σ 2 −(c))
f(c)nh1h2 e1S
−1KS−1e′1
when the same kernels are used for both the treatment and control sides. We consider the optimal pair of bandwidths (h1, h2) that minimizes the above asymptotic MSE. There are two remaining issues in minimizing asymptotic MSE. First, the bias term may disappear when the second derivatives of the treatment and control mean functions are equal. Nevertheless, the second derivatives match exactly only in an extreme scenario. Following (Imbens and Kalyanaraman, 2012), we assume the second derivatives ∂11m+(c) and ∂11m−(c) as well as ∂22m+(c) and ∂22m−(c) are different. Second, we can choose a pair (h1, h2) such that the bias term equals zero when the signs differ across ∂11m+(c)− ∂11m−(c) and ∂22m+(c)− ∂22m−(c). We first consider the optimal bandwidths when both issues are absent, and then consider a remedy when the latter issue arises. When both issues are absent under the following restrictions
∂11m+(c) ̸= ∂11m−(c), ∂22m+(c) ̸= ∂22m−(c), and
sgn { (∂11m+(c)− ∂11m−(c)) ( s̃1κ (2,1) 1 + s̃3κ (2,1,1) 1,2 )} =sgn { (∂22m+(c)− ∂22m−(c)) ( s̃1κ (2,1) 2 + s̃3κ (3,1) 2 )} ,
we attain the unique pair of optimal bandwidths as
h1 h2 =
√ B2(c)
B1(c) and h61 =
(σ2+(c) + σ 2 −(c))
2n e1S
−1KS−1e′1(B −5/2 1 (c)B 1/2 2 (c))
where
B1(c) =(∂11m+(c)− ∂11m−(c)) ( s̃1κ (2,1) 1 + s̃3κ (2,1,1) 1,2 ) , and
B2(c) =(∂22m+(c)− ∂22m−(c)) ( s̃1κ (2,1) 2 + s̃3κ (3,1) 2 ) . The above bandwidths are not optimal when the signs of the bias terms differ. A similar issue arises in the single-variable RD estimation with heterogeneous bandwidths with the treatment and control mean functions (Imbens and Kalyanaraman, 2012). Arai and Ichimura (2018) derive the higher-order expansion of the bias terms for the single-variable RD estimation. In Online Appendix A.2.1, we derive the higher-order expansion of the bias terms. Nevertheless, we do not follow Arai and Ichimura (2018)’s approach because estimating higher-order bias correction terms is unreliable for multivariate RD estimations. As shown in Online Appendix A.2.1, a higher-order bias correction procedure requires a reliable local estimation of a cubic polynomial with 10 coefficients. Instead, we follow Imbens and Kalyanaraman (2012) to rely on regularization. In particular, we take the absolute values of the bias terms B1(c) and B2(c) as
h1 h2 =
( B2(c) 2
B1(c)2
)1/4 and h1 = [ (σ2+(c) + σ 2 −(c))
2n e1S
−1KS−1e′1(|B1(c)|−5/2|B2(c)|1/2) ]1/6 ,
and add regularization terms to B1(c) and B2(c) to prevent the bandwidths from blowing up when the bias terms are zero or close to zero. We note that the optimal ratio h1/h2 is common across the inner and corner solutions of the minimization problem. Given the same bandwidth ratio, we choose h1 from the above formula when the realized signs of the estimated bias terms are the same. If they differ, the bandwidths are determined by regularization, assuming that the bias term disappears. Furthermore, we follow Calonico et al. (2014b) for a bias correction to obtain appropriate inference. We propose a plug-in bias correction with a multivariate local-quadratic estimation. See Online Appendix B for these implementation details. 3 simulation results We demonstrate the numerical properties of our estimator in the following Monte Carlo simulations with four different designs, partially taken from Arai and Ichimura (2018), Calonico et al. (2014b), and Imbens and Kalyanaraman (2012). Specifically, we take four designs of Arai and Ichimura (2018) as the base specifications for the mean function shapes for one of the two dimensions, R2. The four specifications are repeatedly used in other RD studies such as Calonico et al. (2014b) and Imbens and Kalyanaraman (2012) to evaluate their numerical performances. Based on the shapes for R2, we model the two-dimensional mean functions by multiplying a cosine function of the other dimension R1 with the mean functions for R2. We chose the cosine function among trigonometric functions so that their second derivatives in R1 and R2 are nonzero. Figures 2 show the contour plots of the mean functions. Among the four designs, Design 1 has a relatively moderate shape compared to the other specifications. Design 2 has a massive jump on the boundary with similar shapes on both sides; Design 3 is extremely flat
on the treatment side; Design 4 has a complex shape in the treatment side. For each draw of a simulation sample, we draw a random sample of two-dimensional running variables as R1 ∼ U [−1, 1] and R2 ∼ 2×Beta(2, 4)− 1 independent of each other, and generate the outcome variable as m(Ri1, Ri2) + ϵi where ϵi ∼ N(0, 0.12952). We compare the quality of our estimator, rd2dim, relative to the distance estimation
using rdrobust. Figure 3 shows histograms of realized estimates of 3, 000 times replications. The dark-colored histograms of rd2dim have thinner shapes than the light-colored histograms
of distance estimation using rdrobust. Nevertheless, for some specifications, the distance approach achieved better bias corrections than ours. The light-colored histograms are better centered around the vertical line of the true effect than the dark-colored histogram. A close examination of the performance comparisons is presented in Table 1. Our first observation is that estimations with heterogeneous bandwidths h1 ̸= h2 matter. The common estimator is a version of rd2dim that imposes h1 = h2. For all designs, the 95% coverage rate of the true effect size is much worse for common compared to rd2dim, apparently due to better bias correction with heterogeneous bandwidth selection. When we compare rd2dim with distance, the RMSE of rd2dim is less than half of the distance for Designs 1, 2, and 3, and the RSMEs are similar for the two estimators for Design 4. We conjecture that the reason for the massively superior performances in Design 1 and 2 is their sufficient and smooth variations in the mean functions over both axes of R1 and R2. The other designs are less natural as two-dimensional designs than Designs 1 or 2, and have extremely flat or extremely dipping shapes. Specifically, Design 3 is challenging for both approaches as the mean functions are flat. Our rd2dim fails its coverage while distance results in an exploding confidence interval length; both approaches report more than 20% of estimates failed. Our rd2dim is equally favorable in terms of the 95% coverage rate compared with distance, except for Design 3. Given that the assumption for the valid inference is violated (see Section 2.1 for details), the bias-correcting property of rdrobust is surprisingly good for maintaining coverage. Nevertheless, the consequence of the violation appears in much larger confidence intervals for distance relative to our rd2dim for most specifications. 4 application We illustrate our estimator through an empirical application of a Colombian scholarship, Londoño-Vélez et al. (2020b) (Londoño-Vélez et al., 2020a). The scholarship of interest is primarily determined by two thresholds: merit-based and need-based. Consequently, a policy
boundary exists instead of a single cutoff. Our estimator is particularly relevant to their study because of their interest in the heterogeneity over the policy boundary. The outcome of interest is enrollment in any college; hence, the policy impact may be heterogeneous according to their poverty level and their level of academic ability. From 2014 to 2018, the Colombian government operated a large-scale scholarship program called Ser Pilo Paga (SPP). The scholarship loan covers “the full tuition cost of attending any four-year or five-year undergraduate program in any government-certified ‘high-quality’ university in Colombia.” (Londoño-Vélez et al. (2020b), pp.194). The scholarship takes the form of a loan, but the loan is forgiven if the recipient graduates from the university appropriately. The eligibility of the SPP program is three-fold: first, students must have their scores from a high school exit exam exceeding a threshold; second, the students must be from a welfare recipient household; and third, the students must be admitted to an eligible university. The first threshold is merit-based, determined by the nationally standardized high school graduation exam, SABER 11. In 2014 of Londoño-Vélez et al. (2020b)’s study period, the cutoff was the top 9% of the score distribution. The second threshold is need-based, and is determined by the eligibility of the social welfare program, SISBEN. SISBEN-eligible families are roughly the poorest 50 percent. When students’ scores exceed two thresholds, they must be accepted by an eligible college in Colombia to receive the scholarship. Hence, the impact of exceeding both thresholds is not the impact of the program itself owing to noncompliance. The estimand is the impact of the program eligibility, which is the intention-to-treat effect. The aggregation approach is the empirical strategy of Londoño-Vélez et al. (2020b). They run two separate local regressions for the merit-based cutoff among need-eligible students and for the need-based cutoff among merit-eligible students. Figure 4 is a scatter
plot in the space of the need-based criterion (SISBEN) for the x-axis and the merit-based criterion (SAVER11) for the y-axis. Their strategy is to estimate the effect of exceeding the SISBEN threshold for those around the SISBEN score near 0 and of exceeding the SABER11 threshold among those around the SABER11 score near 0. For each aggregated subsample, they run rdrobust based on Calonico et al. (2014b). Londoño-Vélez et al. (2020b) prefer this approach because “the discontinuities represent different populations, and the heterogeneity in estimated impacts across these frontiers is informative” (pp.205). They report the effect of exceeding the merit-based (SABER11) threshold on enrollment in any eligible college is 0.32 with a standard error of 0.012 for the need-based (SISBEN) eligible subsample, and the effect of exceeding the need-based (SISBEN) threshold on enrollment in any eligible college is 0.274 with a standard error of 0.027 for the merit-based (SABER11) eligible subsample. Students with the need eligibility in the x-axis boundary of Figure 4 have a slightly higher effect than students with the merit eligibility in the y-axis boundary of Figure 4. Indeed, their strategy captures certain heterogeneity in the sub-populations, albeit with richer heterogeneity within. The SISBEN threshold students are heterogeneous in their SABER11 scores; the SABER11 threshold students are heterogeneous in their SISBEN scores. We estimate the heterogeneous effects over the entire boundary. We summarize our results in Figure 5. The dark-colored intervals are the pointwise 95% confidence intervals from our rd2dim estimates at each boundary point value, and the light-colored intervals are
the pointwise 95% confidence intervals from the distance estimates. For most points, the two estimates show similar patterns across the boundary points with a notable difference in the length of the confidence intervals. For most of the need-based eligible students (point 3 through 15), our confidence intervals are shorter than the distance-based ones. Furthermore, for the points that the effective sample sizes are much smaller (points 1, 2, 29, and 30), our confidence intervals reflect its noisier estimates. Both estimates suggest substantial heterogeneity in the effects among the merit-eligible students (16 ∼ 30) but not among the need-eligible students (1 ∼ 15). Specifically, the
program has similar effects among the majority of students, but has no impact or even negative impact on extremely capable students (points 25 through 30). The null effect for extremely capable students is reasonable because they would have received other scholarships to attend college anyway. Consequently, the program could have benefited from accepting a larger number of students with higher household incomes because their impact is expected to be similar. One notable difference between the two estimates is the negative impact on the most capable students (points 29 and 30). This negative impact may be consistent with the definition of the dependent variable. The dataset is constructed from the administrative SABER11 and SISBEN scores dataset which is merged with the dataset from the Ministry of Education of Colombia, which tracks students of the postsecondary education system. Hence, the dependent variable may not capture the outside options such as enrolling in the selected US schools. The distance estimation does not capture this heterogeneity and takes the opposite sign from the other estimates. We conjecture that the distance estimation picks the outliers that are away from the boundary because students of the same distance from the point are compared equally. This sign-flipping pattern disappears in the distance estimates when the relative scale of two axes is adjusted by the absolute maximum values of each axis (Appendix Figures 6 and 7). An appropriate relative scaling of the two axes is hardly known, and our rd2dim is free from such a difficult re-scaling task. Hence, our approach is superior in handling the relative scaling of the two-dimensional data as is. 5 conclusion We provide an alternative estimator for RD designs with multivariate running variables. Specifically, our estimator does not convert a multivariate RD estimation problem into a
scalar RD estimation problem. We estimate the multivariate conditional mean functions as is. For the purpose of RD estimations, we develop a new asymptotic result for the multivariate local-polynomial regression with dimension specific bandwidths. In numerical simulations, we demonstrate the favorable performance of our estimator against a frequently used procedure of a distance measure as the scalar running variable. We apply our estimator to the study of Londoño-Vélez et al. (2020b) who study the impact of a scholarship program that has two eligibility requirements. In this application, our estimates are consistent with the original estimates and reveal a richer heterogeneity in the program impacts over the policy boundary than the original estimates. Our contributions can be summarized as follows. First, we demonstrate the issues in the current practices of multivariate RD designs and offer a remedy for them. The distance approach (Black, 1999, Keele and Titiunik, 2015, for example) of converting a multivariate running variable with the Euclidean distance from a point violates the inference assumption of Calonico et al. (2014b); the aggregation approach (Matsudaira, 2008, for example) of aggregating students with eligibility for all but one requirement has limited applicability and capability to capture heterogeneous effects. We provide a strategy for estimating heterogeneous effects without dimension reduction. Second, our asymptotic results complete the theory of multivariate local-polynomial estimates. After Masry (1996) has shown the asymptotic normality of multivariate localpolynomial estimates with common bandwidths between dimensions, no studies have achieved the asymptotic theory with dimension-specific bandwidths. As demonstrated in our simulation results, allowing different bandwidths for each dimension matters substantially for the bias correction procedure, which results in the improved coverage rate of our preferred estimates. However, some theoretical and practical issues remain. First, our consideration is limited to a random sample; hence, spatial RD designs are excluded from our consideration. We defer our focus to spatial design because of its theoretical and conceptual complexity. Nevertheless, we aim to propose a spatial RD estimation based on newly developed asymptotic results of Kurisu and Matsuda (2023) in a separated study. Second, our theoretical results can be applied to any finite-dimensional RD design; however, the practical performance of estimators with more than two dimensions is limited. Although most RD designs have at most two dimensions, the practical implementation of a higher-dimensional RD estimation is an open question. Similarly, we provide the higher-order bias expressions for our multivariate local-polynomial estimates; however, estimating the derived bias expressions is challenging. Therefore, a new approach to exploiting these expressions is desirable. Third, our approach requires a sufficiently large sample over the boundary, and its performance with an extremely small sample size is limited. For a smaller sample, an explicit randomization approach is a compelling alternative. Cattaneo et al. (2015), Cattaneo et al. (2016b) and Cattaneo et al. (2017) propose the concepts and a randomization inference. Their approach requires a substantially stronger assumption but is applicable to a geographical RD design (Keele et al., 2015) as well. Nonetheless, these two approaches are complementary. On the one hand, if one assumes a stronger homogeneous treatment effect assumption around the units at a certain distance from the boundary, then the randomization approach can also be used for a small sample. However, we can relax this strong assumption by using our estimator with a sufficiently large sample. Fourth, covariates are often incorporated in the estimation procedures in RD designs. For the efficiency gain, Frölich and Huber (2019) propose a method with a multi-dimensional non-parametric estimation; Calonico et al. (2019) develop an easy-to-implement augmentation; and recently Noack et al. (2021) considers flexible and
efficient estimation including machine-learning devices and several studies such as Kreiß and Rothe (2021) and Arai et al. (2021) explore augmentation with high-dimensional covariates. We defer these analyses to theoretical and conceptual complications for a companion study for a geographic RD design. Fifth, we provided the optimal bandwidths for multivariate RD estimation; however, the optimal kernel for this class of estimators is unknown. Finally, we do not provide any procedure to aggregate heterogeneous estimates over the set of boundary points. Averaging over boundary points is a preferred feature. For example, a major feature of the rdmulti package, Cattaneo et al. (2020), is averaging over multiple boundary points. In considering the pooling parameter, Cattaneo et al. (2016a) offers the target parameter. Furthermore, Cattaneo et al. (2021) uses a different policy in Columbia with multiple cutoffs to extrapolate the missing part of the support. These ideas can be a good benchmark to consider averaging and extrapolation when the support has holes in the boundary. 