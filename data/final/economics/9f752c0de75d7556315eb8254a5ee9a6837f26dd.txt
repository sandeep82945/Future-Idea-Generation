In this paper, the intra-day multi-interval rollingwindow joint dispatch and pricing of energy and reserve is studied under increasing volatile and uncertain renewable generations. A look-ahead energy-reserve co-optimization model is proposed for the rolling-window dispatch, where possible contingencies and load/renewable forecast errors over the lookahead window are modeled as several scenario trajectories, while generation, especially its ramp, is jointly scheduled with reserve to minimize the expected system cost considering these scenarios. Based on the proposed model, marginal prices of energy and reserve are derived, which incorporate shadow prices of generators’ individual ramping capability limits to eliminate their possible ramping-induced opportunity costs or arbitrages. We prove that under mild conditions, the proposed market design provides dispatch-following incentives to generators without the need for out-of-the-market uplifts, and truthful-bidding incentives of price-taking generators can be guaranteed as well. Some discussions are also made on how to fit the proposed framework into current market practice. These findings are validated in numerical simulations. a. backgrounds Climate change caused by excessive carbon emissions puts urgent demands on the transformation of the energy structure towards more renewable generations. However, unlike conventional generators with fuel inventories, power outputs of renewable generators may change rapidly with time and cannot be accurately forecasted. These two properties are often described as the volatility and uncertainty of renewables. Commonly, they can be handled by inter-temporal generation ramp scheduled in the energy market and intra-temporal operating reserve procured in the ancillary service (AS) market, respectively. Ramp and reserve activation both require instant changes in controllable generators’ outputs, therefore they share generators’ physical ramping capabilities, i.e., how fast generators’ outputs are able to change, which leads to their ramping-induced coupling. Besides, energy and reserve are also coupled in generation capacity and transmission capacity limits. Therefore, with the increasing renewable penetration in modern power systems, it is important to enhance the multiinterval market scheduling of energy and reserve. Jiantao Shi, Ye Guo, Wenchuan Wu and Hongbin Sun are with the Smart Grid and Renewable Energy Laboratory, Tsinghua-Berkeley Shenzhen Institute, Shenzhen, 518071 China. Wenchuan Wu and Hongbin Sun are also affiliated with the State Key Laboratory of Power Systems, Department of Electrical Engineering, Tsinghua University, Beijing, 100084 China. b. related works As recently reported in [1]–[3], it is beneficial for the independent system operator (ISO) to implement the multiinterval rolling-window dispatch when facing the increasing ramp need and forecast uncertainty brought by high-share renewables. In the rolling-window dispatch, to clear the market for an interval that the system is immediately going to enter, the ISO runs a forecast-based optimization for a lookahead scheduling window, which starts with that immediate interval and extends several followed ones into the future. From such look-ahead scheduling, only the result for the immediate interval is binding, while those for future ones are just advisory. This is different from the one-shot dispatch, where the results from one multi-interval optimization are simultaneously binding for all intervals, just like what many ISOs do for their day-ahead scheduling. Moreover, to set aside reliability margins, a fixed reserve requirement, which is typically selected as the capacity of the largest online unit or a percentage of total loads, can also be incorporated to jointly dispatch energy and reserve [4]. Many industrial practices are in line with above methodologies. For example, in NYISO, a look-ahead co-optimization is run every five minutes to financially and physically schedule energy and AS [5]. While in CAISO, the Fifteen-minute market (FMM) is conducted every quarter-hour to determine financially and physically binding AS schedules along with financially binding energy settlements, and then the fixed AS plans are inputted into the five-minute real-time dispatch to arrange physical energy productions at a smaller timescale [6]. At the same time, to enhance the deliverability of reserve, NYISO specifies separate requirements for three different sets of load zones [7], while CAISO does this for eight AS subregions [6]. Some challenging issues, though, arise from current market practices. One question is how to price the rolling-window dispatch, and a natural intuition is the rolling-window extension of the locational marginal pricing (R-LMP). Unfortunately, as shown in [1], ramping-limited generators may suffer opportunity costs at the binding interval under R-LMP and expect to be compensated during the following advisory ones, but such compensations may never be realized as the look-ahead window rolls forward, thus inducing the missingmoney problem of generators, as well as unavoidable out-ofthe-market uplifts to them thereby. To address this problem, some ISOs purchase ramping capabilities from generators as public products and compensate them, including the Ramp Capability Product in MISO [8] and the Flexible Ramping Product in CAISO [9]. However, the actual performance of these ramping products is not satisfactory due to their fairly
ar X
iv :2
30 8. 04 11
2v 1
[ ee
ss .S
Y ]
8 A
ug 2
02 3
2 low or even zero prices during most historical time [10]. Besides the energy pricing, open questions also lie in the reserve market design, like the empirical reserve requirement and the inflexible reserve zone partition, which may not be able to address renewable power uncertainties or guarantee the deliverability of reserve. Moreover, possible generation re-dispatch cost from reserve activation is not considered in the current merit-order-based dispatch that only accounts for the reserve bid-in cost, and methodologies of reserve cost allocation with solid theoretical basis are still lacking. Some of these topics are of high research priority as reported by the National Renewable Energy Laboratory (NREL) [11]. Many studies aim to handle these open questions. On one hand, to address the incentive distortion in R-LMP and reduce ad hoc ramping-induced uplifts, several novel uniform pricing schemes have been proposed, e.g., the multi-settlement LMP in [12] which conducts multiple sequential look-ahead schedules and deviation-based settlements for each interval as an extension of current two-settlement system, and the price-preserving multi-interval pricing (PMP) in [13] which adopts separate models for dispatch and pricing to minimize uplifts under past settled prices. However, [1] establishes that should generators be incentivized to follow the rolling-window dispatch, uplifts are somehow unavoidable for any uniform pricing, which make the overall settlement discriminatory. To avoid such out-of-the-market discrimination, the temporal LMP (TLMP) is proposed in a two-part paper [1], [2] as a non-uniform pricing mechanism, such that the inevitable discriminatory payment becomes in-market. Specifically, TLMP of each generator includes the public LMP and its private ramping shadow price, and the authors prove that TLMP provides dispatch-following and truthful-bidding incentives to generators under the rolling-window dispatch with no need for uplifts. [3] further extends TLMP into a stochastic form. Although these studies provide valuable methods of rollingwindow energy pricing, reserve is somehow absent in their contexts. Some complementary efforts, on the other hand, have been made to fix the reserve-related shortcomings of current market practices, e.g., advanced probabilistic methods of reserve requirement selection [14], [15], and deliverabilityenhancing methodologies including dynamic reserve zone partitions [16] and post-event reserve response policies [17]. In addition to these patches for the current deterministic market design, there have also been some attempts to apply probabilistic optimization techniques on the energy-reserve joint dispatch, e.g., the robust [18] or adjustable robust [19] optimization, the chance-constrained optimization [20], and the scenario-based optimization [21]–[24] that is also adopted in this paper. In [21]–[23], the locational marginal pricing of reserve is developed, and such uniform pricing is further extended to the whole of reserve and re-dispatch in [24]. Furthermore, authors of [24] establish individual rationality and cost recovery of generators for each scenario and revenue adequacy of the ISO in expectation. However, existing scenario-based co-optimization efforts adopt either the singleinterval dispatch e.g. [21], [22], [24] or the multi-interval oneshot dispatch e.g. [23], while their generalizations to the multiinterval rolling-window setting are not properly addressed yet. In a word, although many efforts have been made for the market clearing of energy and reserve, no existing work has adequately handled all their couplings and properly scheduled their multi-interval joint dispatch and pricing in a rollingwindow manner. c. contributions and organizations In this paper, we investigate the multi-interval rollingwindow co-optimization and pricing of energy and reserve with the scenario-oriented approach, as well as market properties therein. The main contributions of this work are threefold:
(1) A rolling-window co-optimization model is proposed. Possible contingencies and load/renewable forecast errors over the look-ahead window are modeled as several scenario trajectories, and they are properly addressed by the coordinated procurement of energy and reserve from generators, leading to the minimized expected system total cost. (2) The rolling-window pricing of energy and reserve is developed following the marginal pricing principle, which provides fundamental insights into their homo- and heterogeneity. For generators, the Lagrangian multipliers associated with their ramping limits are incorporated into their energy and reserve prices to eliminate possible ramping-induced underpayments or arbitrages via an in-market way. (3) Dispatch-following incentives of generators are guaranteed without the need for any out-of-the-market uplift, as well as their cost recovery. Truthful-bidding incentives of pricetaking generators are also proven. The rest of this paper is organized as follows. The cooptimization is formulated in Section II. The pricing mechanism is established in Section III. With the proposed dispatch and pricing, dispatch-following and truthful-bidding incentives of generators are studied in Section IV. Some discussions are made in Section V. Case studies are presented in Section VI. Section VII concludes this paper. Designated symbols are listed in the Appendix A. Note that all vectors and matrices are in bold. ii. problem modeling  a. time line and probability setting We consider the intra-day multi-interval joint scheduling of energy and reserve. We assume that T unit-length intervals are involved in the entire scheduling period H being considered, i.e., H = {1, · · · , T}, and each interval t covers the time duration [t, t + 1). To make better use of the continuously updated forecast as time passes, the market over H is cleared by a sequence of look-ahead co-optimizations, each covers a look-ahead window of W intervals. For example, as shown in Fig. 1, when the ISO stands at t − 1, it conducts a cooptimization over the look-ahead window Ht = {t, · · · , t + W − 1} to produce binding dispatch quantities and prices for the immediate interval t and advisory results for other intervals in Ht. For cases where the remaining period is shorter than W , the co-optimization is conducted over the shrinking lookahead window Ht = {t,· · · ,T}, from t to the end of H . 3 Binding interval Advisory intervals
t-1 t t+1 t+2 t+W-1 t+W T1
Look-ahead window
Fixed parameters Scenario-independent variables Scenario-dependent variables
Fig. 1. ISO’s look-ahead co-optimization over Ht, which produces binding dispatch quantities and prices for the immediate interval t and advisory results for other intervals in Ht based on the system nominal-operation state (the blue line) and scenario trajectories of possible contingencies and load/renewable forecast errors (red lines)
Subsequently, when the ISO actually enters interval t, on one hand, the ISO implements the binding result for t into realtime system operations, and on the other hand, takes that result as an input for the co-optimization over the next look-ahead window Ht+1 = {t + 1, · · · , t +W} to clear the market for t+1. As time goes by, the look-ahead window rolls through the scheduling period H along with evolving binding intervals, thus producing energy and reserve schedules over H in a rolling-window manner. In spirit, such a scheduling process is consistent with the market practice in NYISO [5] and CAISO [6] as described in the Introduction. Specifically, the co-optimization for each look-ahead window Ht schedules generation dispatch for system nominal operation, and simultaneously prepares reserve for possible outages and forecast errors. As the benchmark for the nominal dispatch, the forecast power path of net load (including loads and renewables) over Ht is represented by a blue line in Fig. 1. And for any interval τ in Ht, the ISO optimizes energy g[τ ] from generators to supply that forecast net load under the contingency-absent state. Meanwhile, the ISO’s look-ahead forecast for Ht is not perfect when standing ahead at t − 1, and we assume that possible contingencies and net load forecast errors over Ht are modeled as a set of scenario trajectories St and represented by those red lines in Fig. 1, each of which considers a path of net load forecast error and a sequence of contingency realization over Ht. To cope with possible realizations of any scenario s in system real-time operations, remedial upward and downward re-dispatch δgUs [τ ], δg D s [τ ] of generators are expected, and we endogenously set their reserve provision rU [τ ], rD[τ ] as the biggest range of their generation redispatch among all possible scenarios, such that the exogenous reserve requirement is eliminated. In the next subsection, the corresponding co-optimization is formulated in detail. b. model formulation In this paper, the following assumptions are adopted to formulate our energy-reserve co-optimization model:
i) The cost functions of each generator for providing energy, reserve, and re-dispatch are assumed to be linear. ii) Renewable generations are treated as negative loads. iii) A standard DC power flow model with line-flow constraints is adopted. Power losses on transmission lines are ignored. iv) Possible line contingencies and load forecast errors over each look-ahead window Ht are modeled as a set of scenario trajectories St and handled by reserve, while generator outages are ignored to avoid generation heterogeneity from different outage probabilities. v) The probability of each scenario is assumed to be given. Validations and implications of above assumptions will be revisited in Section V. Accordingly, the co-optimization model for Ht can be formulated as: minimize F t(giτ , r U iτ , r D iτ , δg U iτ,s, δg
D iτ,s, δdlτ,s) =∑
τ∈Ht ∑ i∈NG ( Cgiτgiτ + C U iτr U iτ + C D iτ r D iτ ) + ∑ s∈St ϵs ∑ τ∈Ht ∑ i∈NG ( Cgiτδg U iτ,s−C g iτδg D iτ,s
) + ∑ s∈St ϵs ∑ τ∈Ht ∑ l∈ND CLlτδdlτ,s, (1)
subject to ∀τ ∈ Ht: Ex-ante network constraints for the nominal dispatch:
λτ,0 : ∑ i∈NG giτ = ∑ l∈ND d̂lτ , (2)
ϕτ,0 : SG · g[τ ]− SD · d̂[τ ]≤f , (3) Ex-post network constraints after re-dispatch ∀s ∈ St:
λτ,s : ∑ i∈NG (giτ +δg U iτ,s−δgDiτ,s)= ∑ l∈ND (d̂lτ+ξ̂lτ,s−δdlτ,s),
(4)
ϕτ,s : SG,τ,s · (g[τ ] + δgUs [τ ]− δgDs [τ ]) − SD,τ,s · ( d̂[τ ]+ξ̂s[τ ]−δds[τ ] ) ≤fτ,s, (5)
Re-dispatch constraints ∀s ∈ St, ∀i ∈ NG: (αiτ,s, αiτ,s) : 0 ≤ δgUiτ,s ≤ rUiτ , (6) (β
iτ,s , βiτ,s) : 0 ≤ δgDiτ,s ≤ rDiτ , (7)
Load shedding constraints ∀s ∈ St, ∀l ∈ ND: (γ
lτ,s , γlτ,s) : 0 ≤ δdlτ,s ≤ d̂lτ + ξ̂lτ,s, (8) Generation, reserve, and ramping capability limits ∀i ∈ NG: (υiτ , υiτ ) : Giτ ≤ giτ − rDiτ , giτ + rUiτ ≤ Giτ , (9) (ρD
iτ , ρDiτ , ρ U iτ , ρUiτ ) : 0 ≤ rDiτ ≤ RDiτ , 0 ≤ rUiτ ≤ RUiτ , (10)
µ i(τ−1) : −riτ ≤ giτ − gi(τ−1) − r D iτ − rUi(τ−1), (11) µi(τ−1) : giτ − gi(τ−1) + rUiτ + rDi(τ−1) ≤ riτ . (12)
The objective function (1) consists of three parts over Ht: i) the bid-in cost of energy giτ , upward rUiτ and downward r D iτ reserve in the first row where i is the index of generators, ii) the expected cost for ex-post upward and downward redispatch δgUiτ,s, δg D iτ,s among all possible scenarios St in the second row where ϵs is the probability of any scenario s,1 and iii) the expected cost for ex-post load shedding δdlτ,s among St in the third row where l is the index of loads. 1In this paper, we do not distinguish the cost coefficients of generation and its re-dispatch. Should some generators suffer additional costs for fast ramp, their cost coefficients for re-dispatch can be differentiated from Cgiτ as in [24]. Nevertheless, such settings do not influence the qualitative analysis in this paper. 4 maximum possible downward reserve deployment at upward ramp from to maximum possible upward reserve deployment at maximum possible upward ramping from to maximum upward ramping capability
Fig. 2. Description of the upward ramping limit (12)
For the constraint part, (2)-(3) are the ex-ante energy balancing and transmission capacity constraints for the nominal dispatch at each interval τ in Ht, respectively, where d̂lτ is the forecast power of load l at τ , and g[τ ], d̂[τ ] are vector forms of nominal generation and forecast consumption from all resources, respectively. SG and SD are the shift-factor matrices correspond to generators and loads, respectively, and f is the transmission capacity vector. (4)-(5) are the ex-post network constraints after the realization of any scenario s at τ with i) line outages reflected in SG,τ,s,SD,τ,s,fτ,s different from their nominal values SG,SD,f , ii) load forecast errors ξ̂s[τ ] from their forecast values, and iii) remedial generation re-dispatch and load shedding. These constraints capture the influence of possible re-adjustments on network power flow, thus guaranteeing the scenario-wise deliverability of reserve without the need for empirical reserve zone partition. (6)- (7) link ex-ante reserve procurement with possible ex-post redispatch, and (8) limits load shedding in all scenarios. Moreover, (9)-(10) enforce generators’ capacity and reserve capability limits while (11)-(12) represent ramping ones. Note that in the extreme case, a generator may have opposite redispatch directions for adjacent time intervals as illustrated in Fig. 2, thus its ramp and reserve should satisfy (11)-(12). Note that the solution of the proposed model is much more time-consuming than traditional ones, especially when a large amount of scenarios are considered. Many decomposition methods are applicable to accelerate the solution process e.g. [25], [26]. In this paper, we do not focus on the detailed solution algorithm, but properties of such solution results. By sequentially solving the proposed model F t(·) over H in a rolling-window manner, the energy and reserve dispatch for each generator i can be defined as P̃i = {g∗it, rU∗it , rD∗it ,∀t ∈ H }, (13) and the associated pricing mechanism is developed in the next section. iii. pricing mechanism The proposed pricing mechanism is developed based on the marginal pricing principle. For any interval t, binding settlement prices of energy and reserve are derived from the co-optimization F t(·) over the corresponding look-ahead window Ht. Note that energy and reserve from generators are decision variables in F t(·), whose marginal costs cannot be directly derived. To solve this problem, for each generator i, we fix its energy and reserve git, rUit , r D it for t at their optimums g∗it, r U∗ it , r D∗ it , convert these variables to parameters in F t(·), and consider the rest of the market. Thus we can get a parameterized model
minimize x−it∈X−it
F t−it(x−it),
where x−it represents all decision variables of F t(·) except for git, r U it , r D it of generator i at t, F t −it(·) represents the system
expected cost (1) over Ht excluding the energy and reserve bid-in cost of generator i at t, and X−it includes all the constraints in (2)-(12) except for the intra-temporal internal generation capacity and reserve capability limits (9)-(10) of generator i at t. Then we can derive prices for generator i at t by evaluating the sensitivity of the optimal objective function F t−it(x ∗ −it). Namely, its energy marginal price at t is πgit =− ∂
∂git F t−it(x ∗ −it)
=λ∗t,0 − STG(·,mi)ϕ∗t,0 + ∑ s∈St ( λ∗t,s − STG,t,s(·,mi)ϕ∗t,s ) + ( µ∗it − µ∗it ) − ( µ∗i(t−1) − µ ∗ i(t−1)
) =ω∗mit,0 +
∑ s∈St ω∗mit,s +∆µ ∗ it −∆µ∗i(t−1), (14)
where mi is the index of the bus connecting with generator i. This energy price consists of two components: (i) The second row of (14), denoted by ω∗mit,0 + ∑ ω∗mit,s, represents components of energy balancing and congestion for both the nominal operation ω∗mit,0 and possible nonbase scenarios ∑ ω∗mit,s, which follows the standard form of lossless LMP; (ii) The third row represents ramping components. Specifically, µ∗it−µ∗it, denoted by ∆µ ∗ it, represents the ramping component from time t to t+1, which is non-zero if the generator’s ramping constraints (11)-(12) is binding from t to t+1. Similarly, −(µ∗i(t−1) − µ∗i(t−1)), denoted by −∆µ ∗ i(t−1), represents the ramping component from t− 1 to t. We can observe that the energy price πgit has a locational uniform part (i) and a discriminatory part (ii), which provides fundamental insights into the homo- and heterogeneity of energy from generators: generation resources at the same bus are homogeneous for their non-differentiated contributions to the intra-temporal energy balancing and network congestions, and they are heterogeneous for their differentiated contributions to the inter-temporal ramp flexibility. Similarly, its upward and downward reserve marginal prices at t can be derived as
πUit = − ∂
∂rUit F t−it(x ∗ −it) = ∑ s∈St α∗it,s − µ∗i(t−1) − µ ∗ it , (15)
πDit = − ∂
∂rDit F t−it(x ∗ −it) = ∑ s∈St β ∗ it,s − µ∗i(t−1) − µ ∗ it, (16)
For the first component ∑
α∗it,s in the upward reserve price (15), if generator i’s procured upward reserve capacity is fully squeezed into upward re-dispatch in scenario s, i.e., δgUit,s = r U it , then the binding upward re-dispatch constraint (6) leads to a non-zero multiplier α∗it,s and contributes to this capacity component. Note that generators at the same bus may receive different capacity components in (15) for their different re-dispatch cost coefficients, which make their upward reserve capacities heterogeneous. Other terms in (15) are ramping components just like components (ii) in the generation price (14) since reserve and ramp share the ramping capabilities of generators. Similar analysis also applies to the downward reserve price (16). Moreover, according to (35)-
5 (36) in the Appendix B, we can interpret that any generator with non-zero upward/downward reserve dispatch quantities at t would definitely receive non-negative upward/downward reserve marginal prices for t.
Besides prices for generators, we also derive the energy marginal price of load l at t:
πdlt = ∂
∂d̂lt F t−it(x ∗ −it)
=λ∗t,0 − STD(·,ml)ϕ∗t,0 + ∑ s∈St ( λ∗t,s − STD,t,s(·,ml)ϕ∗t,s ) +
∑ s∈St γ∗lt,s = ω ∗ mlt,0 + ∑ s∈St ω∗mlt,s + ∑ s∈St γ∗lt,s, (17)
which includes similar network components while excluding ramping components compared with the generation price in (14), as well as an additional component ∑ γ∗lt,s brought by the load shedding limit (8). Typically, a non-zero γ∗lt,s appears when load l is totally shed in any scenario s, which reveals its differentiated reliability requirement from other loads and brings in the heterogeneity of electrical demands. If ignoring such cases, load energy prices then become locational uniform. For the settlement of each interval t, each generator is credited for its procured energy, upward reserve, and downward reserve at t, respectively settled with (14)-(16), and each load is charged for its forecast power, settled with (17). Besides, each load also needs to pay for its possible deviations from its forecast power in all scenarios as (assuming γ∗lt,s to be zero):
ΓFlt = ∑ s∈St ∂F t−it(x ∗ −it) ∂ξ̂lt,s ξ̂lt,s = ∑ s∈St ω∗mlt,sξ̂lt,s. (18)
As a result, reserve costs can be endogenously distributed to uncertainty sources in a scenario-wise way. With the look-ahead window sliding across the scheduling period H , the pricing of energy and reserve for each generator i over H can be developed in a rolling-window manner as
π̃i={πgit, π U it , π D it ,∀t ∈ H }. (19)
Based on the rolling-window dispatch P̃i in (13) and pricing π̃i, we study some market properties in the next section. iv. properties In this section, we mainly focus on dispatch-following and truthful-bidding incentives of generators under the proposed rolling-window market-clearing framework. a. dispatch-following incentives Dispatch-following incentives connote that with given prices from the ISO, any generator can maximize its profit by just following the ISO’s dispatch quantities. Specifically, under the proposed market design, after the system has operated throughout the scheduling period H , the energy and reserve clearing prices of any generator i over H are given by π̃i in (19), then the maximum overall profit that generator i would have received from self-scheduling energy and reserve over H can be reviewed with its multi-interval profit-maximization:
Qi(π̃i)= ∑ t∈H (πitgit+π U itr U it+π D itr D it −C g itgit−C U itr U it−CDitrDit ),
(20)
maximize {git,rUit,rDit ,t∈H }
Qi(π̃i), subject to ∀t ∈ H :
(υ′it, υ ′ it) : Git ≤ git − rDit , git + rUit ≤ Git, (21) (ρD ′
it , ρD
′ it , ρ U ′ it , ρU ′ it ) : 0 ≤ rDit ≤ RDit , 0 ≤ rUit ≤ RUit , (22) µ′ i(t−1) : −rit ≤ git − gi(t−1) − r D it − rUi(t−1), (23) µ′i(t−1) : git − gi(t−1) + r U it + r D i(t−1) ≤ rit. (24)
If the energy and reserve dispatch P̃i from the ISO in (13) optimizes the above profit-maximization model, then the pricing π̃i is said to provide dispatch-following incentives to generators under P̃i. On the contrary, if any generator i can be better-off by deviating from P̃i and self-scheduling itself, some lost-of-opportunity-cost (LOC) uplifts shall be needed to compensate its inadequate revenue:
LOC(P̃i, π̃i) = Q ∗ i (π̃i)−Qi(P̃i|π̃i), (25)
where Q∗i (π̃i) is the optimal self-scheduling profit solved from (20)-(24), and Qi(P̃i|π̃i) is the actual profit by following P̃i from the ISO. We establish that the proposed pricing mechanism provides dispatch-following incentives to generators without paying them any extra LOC uplift: Theorem 1 (Dispatch-following Incentives) Under assumptions (i)-(v), consider any generator i. Over the entire scheduling period H , its energy and reserve dispatch quantities P̃i = {g∗it, rU∗it , rD∗it ,∀t ∈ H } and prices π̃i = {πgit, πUit , πDit ,∀t ∈ H } are solved from the proposed model F t(·) in a rolling-window manner. Then {g∗it, rU∗it , rD∗it ,∀t∈H }= argmax
{git,rUit,rDit ,∀t∈H } {Qi(π̃i)|(21)−(24)}. in another word, loc(p̃i, π̃i) = 0. This Theorem ensures dispatch-following incentives of generators. Please check the Appendix B for the proof. A consequent corollary is cost recovery of generators with one additional condition: Corollary 1 (Cost Recovery) Under assumptions (i)-(v), for any generator i with zero generation lower bound i.e. Git = 0, by following the ISO’s dispatch P̃i over H , its total bid-in profit for providing energy and reserve Qi(P̃i|π̃i) is always non-negative. See the Appendix C for the proof. Note that the zero-lowerbound condition is common in the electricity market when considering generators’ cost recovery. b. truthful-bidding incentives Besides the willingness to follow the ISO’s dispatch, we also want to see generators’ voluntarily truthful bidding. This relies on the additional price-taking assumption, i.e., any generator cannot influence the assigned energy and reserve prices from the ISO, which is common in competitive electricity markets. With this additional assumption, we further analyze possible bidding behaviors of any price-taking generator i for the entire scheduling period H . We denote its true marginal costs of energy and reserve and true operational parameters of generation, reserve, and ramping capabilities over H with superscript of ∗ as θ∗i ={C g∗ it , C U∗ it , C D∗ it , G ∗ it, G ∗ it, R U∗ it , R D∗ it , r ∗ it, r ∗ it,∀t∈H }. 6 However, the generator may not submit above true information to the ISO. Instead, it considers the following strategic bidding problem to maximize its profit over H : Πi(θi) =
∑ t∈H ( πgitg ∗ it(θi) + π U itr U∗ it (θi) + π D it r D∗ it (θi) ) −
∑ t∈H ( Cg∗it g ∗ it(θi) + C U∗ it r U∗ it (θi) + C D∗ it r D∗ it (θi) ) , (26)
maximize {θi}
Πi(θi), subject to ∀t ∈ H :
G∗it ≤ g∗it(θi)− rD∗it (θi), g∗it(θi) + rU∗it (θi) ≤ G ∗ it, (27) 0 ≤ rD∗it (θi) ≤ RD∗it , 0 ≤ rU∗it (θi) ≤ RU∗it , (28) − r∗it ≤ g∗it(θi)− g∗i(t−1)(θi)− r D∗ it (θi)− rU∗i(t−1)(θi), (29) g∗it(θi)− g∗i(t−1)(θi) + r U∗ it (θi) + r D∗ i(t−1)(θi) ≤ r ∗ it, (30)
where θi represents any feasible bid of generator i over H , and {g∗it(θi), rU∗it (θi), rD∗it (θi),∀t ∈ H } with superscript of ∗ are the procured energy and reserve quantities of generator i over H from the ISO corresponding to any θi. By submitting different θi, generator i’s procured quantities would also be different, but the clearing prices π̃i = {πgit, πUit , πDit ,∀t ∈ H } from the ISO would never be influenced by the changing bid. Specifically, with θi = θ∗i , generator i is said to bid truthfully for H , and the following Theorem establishes that it is optimal for any price-taking generator to do so: Theorem 2 (Truthful-bidding Incentives) Under assumptions (i)-(v) and that any generator cannot influence the assigned energy and reserve prices from the ISO, consider any generator i. To maximize its profit over H under the dispatch P̃i and pricing π̃i from the ISO, it is optimal for the generator to reveal its true marginal costs and operational parameters with its bid for H , i.e.,
θ∗i = argmax {θi} {Πi(θi)|(27)− (30)}. Check the Appendix D for the proof. These properties validate the effectiveness of the proposed market design. v. discussions In this section, we review the assumptions raised in Section
II, and make some extended discussions. a. revisit of assumptions In assumption (i), we adopt linear bid-in cost functions of energy and reserve for generators. This setting is common in the energy market, but necessities of the reserve capacity bid are somehow controversial in academia. Namely, many existing scenario-based works directly manage generation outputs among all possible scenarios to satisfy scenario-wise operational constraints and minimize the expected production cost, with [27] and [28] being classical works and [3] being a latest one. Such scenario-wise generation scheduling implicitly ensures the system to be operationally flexible. And in that sense, the reserve ancillary service, which is an explicit measurement of flexibility from generators, is not directly modeled in these papers, along with the neglect of the associated capacity bid. However, this may not be in line with real-world market practices. Currently, most ISOs organize bid-based reserve
markets, like NYISO [29] and PJM [30]. In fact, to provide reserve, generators need to constantly operate at varying load levels instead of the base-load level that they are designed for, while such constant cycling would result in the heat-rate degradation of certain generators [31], e.g., fossil steam units and combined cycle units according to PJM’s Manual 15 on cost development [32]. In that manual, the cost-based reserve bid calculations for these generators are exactly built on their possible degrading losses. Therefore, in this paper, we adopt a practical model that incorporates generators’ reserve capacity bids, and make some efforts on reserve pricing to ensure generators’ bid-in cost recovery. We hope our work can bridge the gap between those existing energy-only stochastic optimization efforts from academia and current industrial practices on reserve markets. In assumption (ii), we regard renewable generations as negative loads. In fact, they are also potential reserve providers with stochastic generation upper bounds, and there are several existing pilot explorations on integrating them into AS markets in the U.S., see [33] for a survey. However, their market participation models are still unclear as discussed in [33] and cannot be fully addressed as a part of this paper. Assumption (iii) is standard and consistent with current electricity market design. In assumption (iv), we ignore possible generator outages. Actually, they can be incorporated into the proposed dispatch and pricing through a similar procedure in our previous work [24]. However, such extensions may bring in the heterogeneity of energy and reserve from generators for their differentiated outage probabilities. Since our main focus for this paper is on their ramping-induced heterogeneity, we therefore do not consider generator outages to make our work more concentrated. In assumption (iv), we also use reserve to deal with both possible outages and load/renewable forecast errors. In practice, these two kinds of uncertainties are generally handled by different reserve products, i.e., regulating reserve is often utilized to handle load/renewable forecast errors, while spinning reserve is the main tool to cope with contingencies. Currently, these two different reserve products are both provided mainly by generators. However, considering the enormous reserve need brought by increasing penetration of renewable generations and the fact that other potential suppliers (like virtual power plants) are not yet participating in the reserve market on a large scale, counting on generators to separately set aside generation capacities and ramping capabilities respectively for these two reserve products would place heavy burdens on their operations. Therefore, we attempt to merge these two reserve products, and explore the market design to use one single reserve product to handle both possible outages and load/renewable forecast errors. Meanwhile, we do realize that the control schemes of regulating reserve and spinning reserve are different in industrial practice, which is another key problem in merging these two reserve products apart from the market design issue that we focus on in this paper. Due to the page limit, this problem cannot be addressed as a part of this paper, which is a possible limitation of this work and will be left for our future research. 7 In assumption (v), we regard the probabilities of possible scenarios as given parameters. How to obtain them is indeed out of the scope of this paper, but here we roughly mention some existing related research for reference. Namely, to obtain the probabilities of mixed scenarios covering both load/renewable uncertainties and contingencies, we can assume that contingencies and load/renewable uncertainties are independent as in [34], [35]. Then we can separately calculate the probabilities of load/renewable scenarios and contingency scenarios, and combine them to get the probabilities of mixed ones. How to compute the probabilities of contingency scenarios has been discussed in [36] in detail. Meanwhile, based on the probability distributions of renewable generations, authors of [28] have proposed a novel methodology to select typical renewable scenarios and weight them with proper probabilities, which can also be applied for load uncertainties. b. key points related to market implementations Besides the review on underlying assumptions, some key technical points on implementing the proposed framework into current market practices are also discussed in detail. For regional markets with two-settlement structures, the proposed framework can be regarded as an intra-day market between the day-ahead scheduling and the real-time 5-minute economic dispatch. Specifically, if i) the time duration of each interval is 15 minutes, ii) the energy clearing result g∗it, π g it for the immediate interval is only financially binding, and iii) the reserve result rU∗it , r D∗ it , π U it , π D it is both financially and physically binding, then the proposed market clearing is almost consistent with CAISO’s FMM module [6], with differences in detailed timeline settings and optimization techniques. At the same time, we also realize that some regions are still exploring the deregulation of electric utilities, then our work provides an ad hoc solution to their real-time market constructions, and the results of energy and reserve for the immediate interval should be both financially and physically binding in this case. A closely related question is how to settle possible generation re-dispatch. If the proposed framework is inserted into any two-settlement system as an intermediate step, then the pricing of re-dispatch should follow the rules of the subsequent real-time market. For example, in ERCOT, re-dispatch is settled at the real-time LMP [37]. Meanwhile, for cases where the proposed framework acts as the terminal market-clearing process before real-time operations, the pay-as-bid mechanism can be adopted instead of organizing another round of marginal pricing-based auctions to reduce computational burdens. When discussing possible methods of re-dispatch settlement, it is pertinent to note that the dominant proportion of generation reserve and re-dispatch originates from load/renewable uncertainties, thus how to charge these uncertainty sources is a non-trivial question for the design of stochastic electricity markets. In this paper, we let loads pay for their possible deviations from their forecast powers in all scenarios as in (18). In contrast, another method is to let loads pay only for their actual deviations in a probabilityadjusted manner [38]. Note that the scenario-dependent latter
may expose both the ISO and customers to significant financial risks. See our previous work [24] for detailed comparisons. These discussions on detailed market rules are all related to the ISO’s surplus from organizing the market. Unfortunately, revenue adequacy of the ISO cannot be guaranteed under the proposed market design, which is a possible limitation of this work. One main reason is that the property typically lies beneath the dispatch and pricing given by one single procurement model, whereas the market-clearing decisions over the scheduling period are somehow separately generated by a sequence of look-ahead optimizations in this paper. In general, this is an intractable problem for all rolling-windowbased market approaches. Another reason is that the settlement of possible re-dispatch, which naturally influences the ISO’s surplus in the look-ahead stage, somehow depends on the result of the subsequent real-time market if the proposed framework performs as an intermediate market step instead of the terminal one. In the real world, the ISO is not likely to be able to obtain perfect oracles on the real-time market outcome from a look-ahead perspective, let alone the fact that the ISO’s look-ahead decision itself would also influence the real-time result. Such paradoxes cannot be fully addressed as a part of this paper and will be left for our future work. vi. case study In this section, two toy examples were used to show the non-trivial coupling between energy, reserve, and ramp. Meanwhile, simulations on the ISO-NE 8-zone system [39], [40] with 76 generators were also performed. Note that all quantities were in MW and prices were in $/MWh, which were dropped hereafter for simplicity. a. one-bus toy example We first studied the rolling-window dispatch and pricing for a one-bus case with two generators G1, G2 and one load considering two 15-minute intervals. For G1 and G2, their parameters were given in Fig. 3(a). To clear the market for interval 1, a co-optimization was conducted over the lookahead window Ht=1 = {1, 2} based on the load forecast in Fig. 3(b), where the load power uncertainty over Ht=1 was captured via two scenarios 1 and 2 apart from the system nominal operation with different forecast errors and probabilities 0.1 and 0.15, respectively. Then the binding result for interval 1 was inputted into the co-optimization over the shrinking look-ahead window Ht=2 = {2} to clear the market for interval 2 based on unchanged load forecast in Fig. 3(d). From the look-ahead dispatch result over Ht=1 in Fig. 3(b), we could observe that to satisfy the 690MW load demand in scenario 1 at interval 2, G1 would reach its upper bound 600MW and leave the rest 90MW to G2, including 60MW energy and 30MW upward reserve of G2. The deployment of 30MW upward reserve at interval 2 would occupy a half of G2’s ramping capability from interval 1 to interval 2, and left only 30MW ramping capability for its scheduled generation ramp between these two intervals, which forced G2 to have an output of 30MW at interval 1 while the cheaper G1 was still available to generate more. 8 Price of
G2 t=1 t=2 proposed (30,2,2) (30,2,2)
w/o ramping (25,2,7) (35,7,2)
Dispatch t=1 t=2 G1 (490,15,10) (600,0,0) G2 (30,0,0) (60,30,20)
Load Forecast
(Forecast value, error in S1, error in S2) t=1 t=2 (520,+15, -10) (660,+30, -20)
Dispatch t=2 G1 (600,0,0) G2 (60,30,20)
Load Forecast
(Forecast value, error in S1, error in S2)
t=2 (660,+30,-20)
Price of G2 t=2
proposed (30,2,2) w/o ramping (30,2,2)
(b) Load forecast and dispatch of G1 & G2 over
(c) Pricing of G2 over
(e) Pricing of G2 over
: binding : advisory
Generator G1 G2 Energy bidin price 25 30
Upward/ downward bid-in price 2/2 2/2
Ini�al output 470 50 Capacity 600 600
Reserve capability 400 40
Ramping capability 600 60
(a) Parameters (d) Load forecast and dispatch
of G1 & G2 over
Fig. 3. (a) Generator parameters, (b) look-ahead load forecast and dispatch over Ht=1, (c) look-ahead pricing of G2 over Ht=1, (d) load forecast and dispatch over Ht=2, and (e) pricing of G2 over Ht=2 of the one-bus case
As discussed above, because of its reserve provision, G2’s ramping was limited although its scheduled energy difference between interval 1 and interval 2 was smaller than its ramping rate, and this might further result in its missing-money problem under the traditional pricing but would be overcome under the proposed pricing. Namely, the proposed pricing was compared with the traditional single-interval scenario-wise LMP and reserve pricing in [24], which only considered the marginal cost at any single interval but did not incorporate the temporal effect into the pricing, and would be referred to as the w/o ramping benchmark in Fig. 3 and other followed figures for brevity. Under the benchmark pricing, with the prices in the last row of Fig. 3(c) for interval 1, G2 suffered $37.5 loss at 15-minute interval 1 considering its bid-in costs in Fig. 3(a), and had zero profit at interval 2 with the prices in the last row of Fig. 3(e) for interval 2, leading to its inadequate payment of $37.5 over the 2-interval scheduling period. In contrast, as in the second row of Fig. 3(c) and Fig. 3(e), prices of G2 assigned by the proposed pricing were no less than its bid-in costs in Fig. 3(a) at both intervals, avoiding G2’s underpayment. b. two-bus toy example In the previous one-bus example, generators’ reserve for load uncertainties resulted in limited ramping and further led to inadequate payment. While in this example, we analyzed the rolling-window dispatch of a two-bus case with simple networks for two 15-minute intervals to show that reserve prepared for outages could also bring about similar problems. As shown from the one-line diagram in Fig. 4(b), we considered one constant 90MW load at bus 2 and two generators G1 and G2 at bus 1 and bus 2, respectively, with their parameters in Fig. 4(a). These two buses were linked by a transmission line of two identical branches, each of which had a rating of 50MW. Over the first look-ahead window Ht=1 = {1, 2}, we considered one contingency scenario with a probability of 0.1, which characterized the outage for one of the two branches at interval 2 apart from the contingency-absent nominal operation as shown in Fig. 4(c), and the second look-ahead window Ht=2 = {2} inherited such scenario setting as in Fig. 4(e). Reserve-induced binding ramping also appeared in this example. Namely, from the look-ahead dispatch result over Ht=1 in Fig. 4(c), a counter-intuitive phenomenon was that while the cheaper G1 was still able to generate more and the transmission line still had available capacities to deliver G1’s generation to bus 2 at interval 1, the more expensive G2,
Price of G2 t=1 t=2
proposed (30,2,2) (30,2,2) w/o ramping (25,2,7) (35,7,2)
Dispatch t=1 t=2 G1 (80,0,0) (70,0,20) G2 (10,0,0) (20,20,0)
Outage Forecast (Nominal opera�on, S1) t=1 t=2
(No, No) (No, Yes)
Dispatch t=2 G1 (70,0,20) G2 (20,20,0)
Outage Forecast
(Nominal opera�on, S1)
t=2 (No, Yes)
Price of G2 t=2
proposed (30,2,2) w/o ramping (30,2,2)
(c) Outage forecast and dispatch of G1 & G2 over
(d) Pricing of G2 over
(f) Pricing of G2 over
: binding : advisory
Generator G1 G2 Energy bid-in
price 25 30
Upward/ downward bid-in price 2/2 2/2
Ini�al output 50 10 Capacity 600 600 Reserve capability 400 20
Ramping capability 600 30
(a) Parameters
(e) Outage forecast and dispatch of G1 & G2 over (b) One-line diagram
G1
Bus 1 Bus 2
f=50
f=50
G2
L
Fig. 4. (a) Generator parameters, (b) one-line diagram, (c) look-ahead outage forecast and dispatch over Ht=1, (d) look-ahead pricing of G2 over Ht=1, (e) outage forecast and dispatch over Ht=2, and (f) pricing of G2 over Ht=2 of the two-bus case however, had a non-zero output of 10MW at interval 1. The reason was that with the outage of one branch at interval 2 in the contingency scenario, G1 could only generate 50MW in that scenario limited by the halved post-contingency line capacities, leaving the remaining 40MW load demand to G2. This required G2 to provide 20MW energy and 20MW upward reserve at interval 2, and 20MW reserve deployment would occupy 2/3 of G2’s ramping capability from interval 1 to interval 2, forcing G2 to generate 10MW at interval 1. As noted above, G2’s reserve caused by congestion in the outage scenario induced limited ramping even if its scheduled energy difference between these two intervals was only 1/3 of its ramping rate, and this might further lead to its inadequate payment. Namely, considering G2’s bid-in costs in Fig. 4(a), the prices given by the single-interval scenario-wise pricing in the last row of Fig. 4(d) for interval 1 resulted in $12.5 deficit of G2 at 15-minute interval 1, as well as zero profit at interval 2 with the prices in the last row of Fig. 4(f) for interval 2, leading to G2’s $12.5 underpayment over the 2-interval scheduling period. In contrast, by comparing the second row of Fig. 4(d) and Fig. 4(f) with G2’s bid-in costs in Fig. 4(a), we could observe that G2 was not underpaid under the proposed pricing. C. ISO-NE 8-zone case
1) Test settings: Simulations were also performed on the 8- zone ISO-NE system for 300 independent scheduling days under different ramping cases. The topology profile and generator parameters were originally from [39], [40]. In this paper, the capacities of all transmission lines were set as 900MW, with a short-term exceeding rate of 1.1 after uncertainty realizations and re-adjustments in all scenarios. At the same time, the bidin costs of upward and downward reserve were set as 1/5 of energy bid-in costs. Under these settings, the proposed market mechanism was tested under varying ramping capability levels of generators. In the ISO-NE 8-zone case, there were originally two groups of generators with distinguished ramping limits, i.e., Group 1 including G1-G31, and Group 2 including G32G76. For these two groups of generators, we defined seven ramping cases A-G: for the most relaxed ramping case G, all Group-1 generators’ ramping limits were set at 500MW, and all Group-2 generators’ ramping limits were 700MW; for the most stringent A, both Group-1 and Group-2 generators’ ramping limits were set at 300MW; A, G, and five other ramping cases B-F were depicted in Fig. 5(a). 9 A B C D E F G
200
300
400
500
600
700
800
250 350 450 550
) W M( 2 puor Gfoti mil gnip ma R
Ramping limit of Group 1 (MW)
(a) Different Ramping Cases
Fig. 5. (a) Ramping cases and (b) load paths of ISO-NE 8-zone case
After giving seven ramping cases, we then defined 300 independent scheduling days. On one hand, with the hourly zonal load profile in ISO-NE as the average load path [41], 300 load realizations for these scheduling days were generated with a standard deviation of 4% and presented in Fig. 5(b). On the other hand, for the equipment status in these scheduling days, we considered possible outage of Line 11 between zone CT and zone RI and assumed its outage to follow a Markov process with a well-functioned initial state at the beginning of each scheduling day, an outage rate of 1% per hour, and a zero repair rate. Based on this model, 300 realizations of Line 11’s 24-hour status were generated for these scheduling days. After defining 300 independent scheduling days, for each of them, simulations were done via the proposed rolling-window dispatch, where each look-ahead window covered 4 hourly intervals. For the forecast model, when the ISO stood at t− 1 and conducted the look-ahead forecast over Ht, the forecast error of any load at interval t+k−1 was assumed to follow the normal distribution with a zero mean and a 0.036k% variance, and the ISO’s knowledge on Line 11 was limited to its status at t − 1 and its Markov model described above. To consider these uncertainties, 50 scenarios of forecast errors and outages were generated to drive each look-ahead dispatch. 2) System cost and ISO’s surplus: We first compared the average system cost of the proposed model among these scheduling days under ramping case A with that of the deterministic model formulated in the Appendix E, which was referred to as the w/o scenario benchmark in Fig. 6(a) and other followed figures. Namely, for any interval in any scheduling day, we first calculated the binding energy and reserve results and clearing costs with the proposed model, and then calculated the re-adjustment costs of re-dispatch and load shedding to handle actual load forecast errors and outages at that interval. By adding them up, we could obtain the system total cost of the proposed model at that interval. Then we repeated that process for the deterministic model under different reserve requirement parameters, i.e., different ratios of system total loads. The average result among all scheduling days was presented in Fig. 6(a), where the green curve represented the average system total cost of the deterministic model under different reserve requirements, and the blue line represented the result of the proposed model. We could observe that the proposed model achieved a lower system total cost than the traditional deterministic model in this test. In addition to the system cost, we also evaluated the ISO’s merchandise surplus under the proposed method as in Fig. 6(b), where each blue circle represented the ISO’s surplus in one scheduling day under one ramping case. The result in Fig. 6(b) showed that in all scheduling days, the merchandise surplus of the ISO stayed non-negative under all ramping cases, validating the ISO’s revenue adequacy in this example. 3) Incentive compatibility: Next we verified dispatchfollowing incentives of generators, which were evaluated via
5 10 15 20 25 Reserve Requirement Ratio %
4
6
8
10
12
14
A ve
ra ge
S ys
te m
C os
t / $
106 (a) Average System Cost
w/o scenario proposed
A B F GD 0
0.5
1
1.5
2
Su rp
lu s o
f I SO
/$
105 (b) Surplus of ISO
Ramping Case ID C E
Fig. 6. (a) Average system costs under ramping case A and (b) the ISO’s surplus in all scheduling days under ramping cases A-G
A B C E F G Ramping Case ID
0
2000
4000
6000
8000
10000
LO C
U pl
ift /$
(a) Dispatch-following Incentives w/o ramping proposed w/o scenario
10 20 30 40 50 60 70 Geneartor Index
-1500
-1000
-500
0
500
Pr of
it C
ha ng
e /$
(b) Truthful-bidding Incentives w/o ramping proposed w/o scenario
D
Fig. 7. (a) Average LOC uplifts under ramping cases A-G and (b) average profit changes of generators from truthful ramping revealing to withholding 20% ramping under ramping case A
the LOC uplift calculated by (25). Specifically, under ramping cases A-G, the average uplift of the proposed pricing among these scheduling days was presented in Fig. 7(a) as the blue curve, and was compared with the results of two benchmarks: (i) the red curve represented the result of the single-interval scenario-wise LMP and reserve pricing obtained from the proposed scenario-based model, and (ii) the green curve represented the result of the deterministic LMP and reserve pricing obtained from the deterministic model in the Appendix E. We could observe that the uplift under the proposed pricing was constantly at zero under different ramping cases, which validated dispatch-following incentives of the proposed pricing. On the contrary, the uplift was necessarily non-zero under both benchmarks, and would grow higher with the ramping becoming more stringent. Meanwhile, to examine generators’ incentives to reveal their truthful ramping, under ramping case A, we calculated the average profit change of each generator from truthful ramping revealing to withholding its ramping capability by 20% among these scheduling days and presented the result in Fig. 7(b), where the blue curve represented the result under the proposed pricing, while the red and green curves respectively corresponded to benchmarks (i) and (ii) described above. We could see that under both benchmarks, some generators could benefit from revealing false ramping, e.g., G1/G2 under the deterministic LMP and reserve pricing, and G24/G33 under the single-interval scenario-wise pricing. On the contrary, under the proposed pricing, no generator could benefit from hiding true ramping, validating their ramping-revealing incentives. vii. conclusion This paper provides a solution to the intra-day rollingwindow joint dispatch and pricing of energy and reserve, which is necessary for the accommodation of increasing volatile and uncertain renewables but has not been properly addressed yet in both industry and academia. A novel rollingwindow energy-reserve co-optimization has been proposed to coordinate inter-temporal ramp with intra-temporal reserve and minimize the expected system total cost considering scenario trajectories of possible outages and load/renewable deviations. 10
Based on the proposed model, marginal prices of energy and reserve have been derived, which incorporate the Lagrangian multipliers of generators’ private ramping limits to eliminate their possible ramping-induced opportunity costs or arbitrages. Indicated by the proposed pricing, generation resources at the same bus are heterogeneous for their differentiated ramping capabilities, and reserve resources are further heterogeneous for their differentiated re-dispatch marginal costs. Based on the proposed dispatch and pricing, dispatch-following and truthful-bidding incentives of generators have been proved, and revenue adequacy of the ISO has been numerically validated in the case study. appendix a notations and nomenclatures The notations and nomenclatures are presented in Table I. 11 appendix b proof of dispatch-following incentives We first consider some KKT conditions of the proposed look-ahead co-optimization F t(·) over Ht as follows:
∂L∗t ∂git =−(λ∗t,0−STG(·,mi)ϕ∗t,0)− ∑ s∈St (λ∗t,s−STG,t,s(·,mi)ϕ∗t,s)
− ( µ∗it−µ∗it ) + ( µ∗i(t−1)−µ ∗ i(t−1) ) +Cgit+υ ∗ it−υ∗it
=0, (31) ∂L∗t ∂rUit =− ∑ s∈St α∗it,s + µ ∗ i(t−1) + µ ∗ it + CUit + υ ∗ it − ρU∗it + ρ U∗ it =0, (32) ∂L∗t ∂rDit =− ∑ s∈St β ∗ it,s + µ ∗ i(t−1) + µ ∗ it + C D it + υ ∗ it − ρD∗it + ρ D∗ it
=0, (33)
where L∗t represents the optimal Lagrangian of F t(·). With the pricing formulations in (14)-(16) of πgit, π U it , π D it , these KKT conditions can be further transformed into ∂L∗t ∂git = −πgit + C g it + υ ∗ it − υ∗it = 0, (34) ∂L∗t ∂rUit = −πUit + CUit + υ∗it − ρU∗it + ρ U∗ it = 0, (35) ∂L∗t ∂rDit = −πDit + CDit + υ∗it − ρD∗it + ρ D∗ it = 0. (36)
We next consider the case where each generator i selfschedules its energy and reserve provision at t to maximize
its profit at t with given prices πit = {πgit, πUit , πDit } from the ISO for t, and write the corresponding model as:
Qit(π̃it)= ( πgitgit+π U itr U it+π D itr D it ) − ( Cgitgit+C U itr U it+C D itr D it ) ,
(37) maximize {git,rUit,rDit} Qit(π̃it), subject to: (υ′it, υ ′ it) : Git ≤ git − rDit , git + rUit ≤ Git, (38) (ρD ′
it , ρD
′ it , ρ U ′ it , ρU ′ it ) : 0 ≤ rDit ≤ RDit , 0 ≤ rUit ≤ RUit , (39) (µ′
i(t−1)) : −rit ≤ git − gi(t−1) − r D it − rUi(t−1), (40)
(µ′i(t−1)) : git − gi(t−1) + r U it + r D i(t−1) ≤ rit. (41)
For the above model, if we set
µ′ i(t−1) = 0, µ ′ i(t−1) = 0, ρ
D′
it = ρD∗ it , ρD
′
it = ρ D∗ it ,
ρU ′ it = ρU∗ it , ρU ′ it = ρ U∗ it , υ ′ it = υ ∗ it, υ ′ it = υ ∗ it (42)
where ρD∗ it , ρD∗it , ρ U∗ it , ρU∗it , υ ∗ it, υ ∗ it are optimally solved from the proposed co-optimization F t(·) over Ht, then based on (34)-(36), we can observe that this set of dual variables in (42) and the set of primal variables {g∗it, rU∗it , rD∗it } solved from F t(·) satisfy the KKT conditions of the model in (37)- (41), which indicates that
{g∗it, rU∗it , rD∗it } = argmax {git,rUit,rDit} {Qit(π̃it)|(38)− (41)}. Furthermore, from (42), we can observe that {g∗it, rU∗it , rD∗it } optimizes Qit(π̃it) with the Lagrangian multipliers of ramping constraints (40)-(41) being zero, what means that {g∗it, rU∗it , rD∗it } also optimizes Qit(π̃it) for the rampunconstrained case, i.e.,
{g∗it, rU∗it , rD∗it } = argmax {git,rUit,rDit} {Qit(π̃it)|(38)− (39)}. This can be easily augmented to the ramp-unconstrained multiinterval profit-maximization over H as
{g∗it, rU∗it , rD∗it ,∀t∈H}= argmax {git,rUit,rDit ,∀t∈H} {Qi(π̃i)|(21)−(22)}. Meanwhile, since the ramping constraints of generators are indeed incorporated into every F t(·) for t ∈ H , then it is obvious that {g∗it, rU∗it , rD∗it ,∀t ∈ H } given by the ISO definitely satisfies generators’ ramping constraints over H , which indicates that {g∗it, rU∗it , rD∗it ,∀t ∈ H } also optimizes Qi(π̃i) for the ramp-constrained case, i.e.,
{g∗it, rU∗it , rD∗it ,∀t∈H}= argmax {git,rUit,rDit ,∀t∈H} {Qi(π̃i)|(21)−(24)},
proving Theorem 1. appendix c proof of cost recovery The proof of cost recovery is quite intuitive. Namely, With the additional zero-lower-bound assumption, consider any generator i. A feasible solution to its multi-interval profitmaximization in (20)-(24) is to provide zero energy and reserve over H and earn a zero bid-in profit over H . At
12
the same time, according to Theorem 1, the optimal solution is to follow the ISO’s dispatch of energy and reserve P̃i over H . Therefore, by following P̃i over H , generator i can earn an overall bid-in profit that is no less than zero, proving its cost recovery. appendix d proof of truthful-bidding incentives We first revisit the strategic bidding model of any generator i given in (26)-(30). The truthful operational parameters of generator i in constraints (27)-(30) actually construct its truthful feasible dispatch region over H , which limits generator i’s bidding behavior as it wants the rolling-window dispatch of energy and reserve from the ISO to fall into that region, otherwise it would not be physically able to follow. Moreover, note that when bidding truthfully, the profit of generator i over H can be expressed as
Πi(θ ∗ i )= ∑ t∈H ( πitg ∗ it(θ ∗ i )+π U itr U∗ it (θ ∗ i )+π D itr D∗ it (θ ∗ i ) )
(43)
− ∑ t∈H ( Cg∗it g ∗ it(θ ∗ i )+C U∗ it r U∗ it (θ ∗ i )+C D∗ it r D∗ it (θ ∗ i ) ) ,
where {g∗it(θ∗i ), rU∗it (θ∗i ), rD∗it (θ∗i ),∀t ∈ H } are the ISO’s dispatch quantities over H with truthful bid θ∗i from generator i. From dispatch-following incentives in Theorem 1, we can further interpret that
Πi(θ ∗ i ) = ∑ t∈H ( πitg ∗ it(θ ∗ i )+π U itr U∗ it (θ ∗ i )+π D itr D∗ it (θ ∗ i ) )
− ∑ t∈H ( Cg∗it g ∗ it(θ ∗ i )+C U∗ it r U∗ it (θ ∗ i )+C D∗ it r D∗ it (θ ∗ i ) )
=Q∗i (·|θ∗i ), (44)
where Q∗i (·|θ∗i ) is the optimal value of generator i’s multiinterval profit-maximization (20)-(24) with its cost coefficients and operational parameters being truthful θ∗i , which further implies that
Πi(θ ∗ i ) = ∑ t∈H ( πitg ∗ it(θ ∗ i )+π U itr U∗ it (θ ∗ i )+π D itr D∗ it (θ ∗ i ) )
− ∑ t∈H ( Cg∗it g ∗ it(θ ∗ i )+C U∗ it r U∗ it (θ ∗ i )+C D∗ it r D∗ it (θ ∗ i ) )
=Q∗i (·|θ∗i ) ≥ ∑ t∈H (πitgit+π U itr U it+π D itr D it −C g∗ it git−C U∗ it r U it−CD∗it rDit)
(45)
for any set of {git, rUit , rDit ,∀t ∈ H } that lies in generator i’s truthful feasible dispatch region. Note that no matter how generator i submits its bid θi, the dispatch over H that it receives must be within its truthful feasible dispatch region. Therefore, any feasible bid θi definitely corresponds to a set of {git, rUit , rDit ,∀t ∈ H } in the truthful feasible dispatch region. Combining this with (45), we can terminally interpret that
Πi(θ ∗ i ) ≥ Πi(θi), (46)
proving Theorem 2. appendix e benchmark: deterministic co-optimization U t = ∑ τ∈Ht ∑ i∈NG ( Cgiτgiτ + C U iτr U iτ + C D iτ r D iτ ) , (47)
minimize {giτ ,rUiτ ,rDiτ ,∀τ∈Ht}
U t(·), subject to ∀τ ∈ Ht:
λτ : ∑ i∈NG giτ = ∑ l∈ND d̂lτ , (48)
ϕτ : SG · g[τ ]− SD · d̂[τ ]≤f , (49)
(χUτ , χ D τ ) : ∑ i∈NG rUiτ = Req U τ , ∑ i∈NG rDiτ = Req D τ , (50) Giτ ≤ giτ − rDiτ , giτ + rUiτ ≤ Giτ , (51) 0 ≤ rDiτ ≤ RDiτ , 0 ≤ rUiτ ≤ RUiτ , (52) − riτ ≤ giτ − gi(τ−1) − rDiτ − rUi(τ−1), (53) giτ − gi(τ−1) + rUiτ + rDi(τ−1) ≤ riτ , (54)
where ReqUτ /Req D τ are the upward/downward reserve requirement parameters at interval τ . Based on this model, the deterministic LMP of any generator i at t is
ηgit = λ ∗ t − STG(·,mi)ϕ∗t , (55)
and its deterministic upward and downward reserve pricing at t is
ηUit = χ U t , η D it = χ D t , (56)
respectively.