This paper presents the integration of active disturbance rejection control (ADRC) with soft sensors for enhancing the composition control performance in a distillation column. Static and dynamic soft sensors are developed to estimate the top and bottom product compositions using multiple tray temperatures. In order to cope with the collinearity issues in tray temperature measurements, static and dynamic principal component regression is used in developing the soft sensors. The soft sensor outputs are introduced as the feedback signals to ADRC. This control scheme is termed as “inferential ADRC control”. Static control offsets are eliminated through mean updating in the soft-sensor models. The effectiveness of the proposed control scheme is demonstrated on a benchmark simulated methanol-water distillation column. 1. introduction In the last decades, the proficient and efficient use of energy has become a highly significant issue in the industrial sector since the prices of energy as well as environmental awareness are continuously increasing. Thus, industry is highly interested in approaches for minimizing the energy consumption in industrial processes [1]. Distillation is still one of the most commonly used and one of the most versatile separation methods for separating liquid mixtures in petrochemical and chemical industries accounting for about 25–40% of the energy usage in the sector. Due to its relatively low energy efficiency, this unit process is often one of the biggest energy consumers in industrial processes. When considering energy efficiency in any type of distillation columns, it is really necessary to account for the form of energy being consumed and the quality of cooling and heating required. Trade-offs exist between environmental impact, cost, energy sources and equipment requirements. Distillation columns consume a huge amount of energy for providing heat required to convert liquid to vapor and then condense the vapor back to liquid via the condenser. Distillation uses more than 40% of the amount of energy utilized in the refining and bulk chemical process industry and more than 90–95% of energy consumed in liquid separation and purification, and accounts for more than 3% of the energy consumption in the world [2]. Moreover, the capital investment of these distillation systems is indicated to be at least eight billion US dollars which can contribute to greater than 50% of both capital and plant operating costs in a typical chemical plant which can have a significant impact on the overall plant profitability [3]. The minimum energy expected to be consumed in distillation columns depends on various operation variables such as temperature spans and operating pressures and the optimization of these variables leads to reducing the energy demand while meeting product quality and quantity requirement [4]. It is very likely that distillation will continue to be the choice of liquid mixture separation for the next decade as it is still labelled “as the technique of choice for many current purification and separation operations” but it needs to make radical modifications and changes to reduce energy consumption. Sensors 2023, 23, 1019. https://doi.org/10.3390/s23021019 https://www.mdpi.com/journal/sensors
Sensors 2023, 23, 1019 2 of 17
With the rising environmental concerns and growing energy awareness there is a need to minimize the energy use in all industry sectors [4]. Advanced control of distillation columns is one way of improving their energy efficiency. The control of distillation column must drive the product compositions as close to their desired set-points as possible in the faces of unexpected disturbances in feed flow rate and feed composition. However, it is quite difficult to get reliable and accurate product compositions economically on-line and without time delay. The time delay in most composition analyzers is typically between 10–20 min. Such large time delays cause poor control performance and degraded process operation because the effects of disturbances remain undetected for substantial periods of time. The most common alternative technique to product composition control using composition analyzers is indirect composition control through tray temperature control. However, single tray temperatures are not very accurate indicators of product compositions especially under disturbances. Therefore, one approach to overcome this issue is to implement inferential control with multiple tray temperatures in conjunction with advanced control scheme, such as the active disturbance rejection control (ADRC) scheme, to improve the overall control performance. Inferential control using soft sensors is capable of alleviating the issue of large measurement delays by using secondary outputs (tray temperatures) to infer the state of primary outputs (product compositions). This paper is organized as follows: Section 2 gives an overview of ADRC and inferential control. A binary methanol–water separation column is presented in Section 3. Section 4 presents an inferential ADRC control strategy for binary distillation columns. Both static and dynamic soft sensors implementation for product composition using principal component regression (PCR) is presented in Section 5. Section 6 presents the control performance of inferential ADRC. The last section presents some concluding remarks. 2. an overview of active disturbance rejection control and inferential control  2.1. active disturbance rejection control Many industrial plants in the real world are not just time varying and nonlinear but also highly uncertain. The design of control systems for such plants has been the focus of much of the current improvements and developments under the umbrella of adaptive, robust and nonlinear control. However, most of the proposed control methods are based on the assumption that a fairly accurate mathematical model of the plant is available and due to their dependence and complexity on advanced analytical methodologies and mathematical model, these methods have certain limitations in engineering applications. According to the well-known control theorist Roger Brockett that if there is no uncertainty in the system, then feedback control is largely unnecessary [5]. Recognizing the vulnerability and sensibility of the reliance on accurate mathematical models of many modern control algorithms, there has been a gradual avowal over the years that active disturbance estimation is a practical alternative to accurate plant models. Moreover, if a disturbance exists in the plant and is represented by the discrepancy between the industrial plant and its model, then this disturbance can be estimated in real time. Then, the plant-model mismatch can be successfully and efficiently compensated for, making the model-based design tolerant of a considerable number of uncertainties. The main focal point in the close control of such plants is how unknown dynamics and external disturbance can be predicted or estimated. ADRC was introduced in 1995 by Prof. Jinqing Han at the Chinese Academy of Science [6–9]. However, most of the earlier papers are in Chinese and the concept of ADRC was first introduced into English literature in 2001 by Gao [10–12]. The methodology of ADRC has been in development for over two decades and has been utilized in various engineering applications. It has been considered as an alternative paradigm in control engineering to address and investigate non-linear and time variant systems [12]. ADRC is considered as an advanced form of principle of active control (PAC) and inherits its concept from the limitations of proportional–integral–derivative (PID) which are error computation, oversimplification of control law as the form of linear weighted sum (LWS), noise degra-
Sensors 2023, 23, 1019 3 of 17
dation associated with the derivative term and complications associated to the integral control term. The main advantages of ADRC are model independency and disturbance rejection [11,12]. Figure 1 shows the ADRC structure which consists of three main parts: transient profile generator (TPG), non-linear weighted sum (NWS), and extended state observer (ESO). Sensors 2023, 23, x FOR PEER REVIEW 3 of 17
engineering applications. It has been considered as an alternative paradigm in control engineering to address and investigate non-linear and time variant systems [12]. ADRC is considered as an advanced form of principle of active control (PAC) and inherits its concept from the limitations of proportional–integral–derivative (PID) which are error computation, oversimplification of control law as the form of linear weighted sum (LWS), noise degradation associated with the derivative term and complications associated to the integral control term. The main advantages of ADRC are model independency and disturbance rejection [11,12]. Figure 1 shows the ADRC structure which consists of three main parts: transient profile generator (TPG), non-linear weighted sum (NWS), and extended state observer (ESO). Figure 1. Structure of ADRC. TPG proposed in [9] is a second order system that may produce smooth transition output process tracking the input set-point signal. Moreover, it is an effective technique to solve the conflict between avoiding overshoot and quickness in response of the controlled variable. Han [9] proposed that TPG could be constructed by using the following equation. ⎩⎪⎨ ⎪⎧ 𝑉 = 𝑉𝑉 = −𝑟 𝑠𝑖𝑔𝑛 𝑉 − 𝑉 + 𝑣 |𝑣 |2 𝑟 𝑉 = 𝑓ℎ𝑎𝑛 (𝑣 − 𝑣(𝑡), 𝑣 , 𝑟, ℎ ) (1)
In the above equation, 𝑉 is the setpoint for the controlled variable, 𝑉 is the desired trajectory, 𝑉 is the derivative of the desired trajectory, r is sometimes called tracking speed, ℎ is the filtering factor, and 𝑓ℎ𝑎𝑛 is the Han function [9]. It can be noticed that the value of the parameter r can be selected depending on the physical limitation of the plant. The speed of the transient profile can be slowed down or speeded up by selecting a suitable value of r. Usually, the conventional PID control employs a linear combination of proportional (present), integral (accumulative) and derivative (predictive) of the tracking errors. Moreover, other possibilities of combinations that might be much more effective are ignored. In addition, it usually needs the strategy on trade-off between fastness and overshoot of the control response. In order to avoid this contradiction, Han [9] gives an alternative nonlinear function which depends on the magnitude of error signal to produce the control signal. Systems are operating under different types of disturbances, among which the ones that have some impacts on the output signal are the most significant. As a result, the disturbances can be separated from the output signal by creating or defining new state which
Transient profile generator (TPG)
Nonlinear weighted
sum (NWS) Plant
Extended state observer (ESO)
Setpoint v + -
+ - + -
v1
v2
z1
z2
z3
u y
Figure 1. Structure of ADRC. TPG proposed in [9] is a second order system that may produce smooth transition output process tracking the input set-point signal. Moreover, it is an effective technique to solve the conflict between avoiding overshoot and quickness in response of the controlled variable. Han [9] proposed that TPG could be constructed by using the following equation. . V1 = V2. V2 = −rsign ( V1 −V + v2|v2|2r )
. V2 = f han(v1 − v(t), v2, r, h0)
(1)
In the above equation, V is the setpoint for the controlled variable, V1 is the desired trajectory, V2 is the derivative of the desired trajectory, r is sometimes called tracking speed, h0 is the filtering factor, and f han is the Han function [9]. It can be noticed that the value of the parameter r can be selected depending on the physical limitation of the plant. The speed of the transient profile can be slowed down or speeded up by selecting a suitable value of r. Usually, the conventional PID control employs a linear combination of proportional (present), integral (accumulative) and derivative (predictive) of the tracking errors. Moreover, other possibilities of combinations that might be much more effective are ignored. In addition, it usually needs the strategy on trade-off between fastness and overshoot of the control response. In order to avoid this contradiction, Han [9] gives an alternative nonlinear function which depends on the magnitude of error signal to produce the control signal. Systems are operating under different types of disturbances, among which the ones that have some impacts o the output signal are the most significant. As a result, the disturbances can be separated from the output signal by creating or defining new state which can be done by ESO. ESO generates the timates of the unknown disturbances and unmeasured system states and then compensates them. Furthermore, ESO can enhance the system performance daptabili y. Consider the following 2nd order system [9]: . x1 = x2. x2 = f (x1, x2, de, t) + bu y = x1
(2)
where y is the system output, u is the manipulated variable for controlling y, and f (x1, x2, de, t) is a multivariable function of the states x1 and x2, the undesired external disturbance de,
Sensors 2023, 23, 1019 4 of 17
and time t. This function reflects the effect of the total disturbance dt(t). Using the total disturbance dt(t) as an additional state variable, Equation (2) can be organized as follows: . x1 = x2. x2 = x3 + bu. x3 = dt(t)
y = x1
(3)
The states x1(t) to x3(t) can then be estimated by an ESO and the estimated states are denoted as z1(t) to z3(t) respectively. By inspecting Figure 1 and in order to remove the impact of the total undesired disturbance on the controlled variable, the control law of the ADRC scheme can be written as:
u = g− z3(t)
b0 (4)
where g is the desired closed loop dynamics, z3(t) is the estimate of the total disturbance dt(t), and b0 is an approximation of the parameter b in Equation (2). 2.2. overview of inferential control The increasing availability of a wide range of sensors and data acquisition systems has led to a corresponding rise in the amount of data that can be logged through the computer control and monitoring systems of industrial processes. Hardware sensors give information on the process operation in terms of process variables, such as pressures, temperatures and flow rates, and product quality variables, such as composition and polymer molecular weight. Such sensors for product quality variables can be utilized to provide information on the quality of the final product in order to certify that it satisfies the customer requirements. However, many product quality variables cannot be easily and economically measured. Such sensors like composition analyzers usually possess large measurement delay and they are usually expensive. In many cases, the main product quality indicators are generally obtained by off-line sample analysis in a scientific laboratory. On-line quality analyzers such as gas chromatography and Near-InfraRed (NIR) are typically expensive and usually incur high maintenance cost [13,14]. Furthermore, significant delays and discontinuity associated with slowly processed quality measurements and laboratory analysis of online analyzers may reduce the efficiency and effectiveness of control policies. Instead of product composition control using composition analyzer and NIR, tray temperature control is broadly used to indirectly control product compositions. Moreover, tray temperature measurements are economic, reliable and virtually without any measurement time delays. However, utilizing single tray temperature to characterize the product composition has some drawbacks such as column pressure variation and feed rate or composition variation can significantly affect the correlation between tray temperatures and product compositions. In industrial processing plants, such restriction and limitations can have a severe impact on product quality. In an effort to overcome the problems encountered in product composition measurement, soft sensing or inferential estimation techniques have acquired momentum recently as viable alternatives to hardware sensors in on-line process monitoring and control [15]. In the last two decades, there has been rising interest and research in the development of soft sensors to provide regular on-line predictions of quality variables based on easy-to-measure process variables. Such soft sensors provide real time estimates of product quality variables and help to improve closed loop control performance and develop tight control policies [16]. A soft sensor can be considered as a mathematical model that generates reliable real time estimates of unmeasured variables from easy-to-measure process variables [16]. There are various advantages of soft sensors in the monitoring and control of industrial processes:
• They provide more insight into the process through catching the information hidden in data;
Sensors 2023, 23, 1019 5 of 17
• They provide enhanced monitoring and control of industrial processes with the consequences of reducing environmental impact, enhancing productivity and energy efficiency, and improving business profitability through decreasing the production cost related to off-specification products; • They can be simply implemented on existing hardware. Moreover, on-line model identification algorithms can be utilized to adapt the model when plant characteristics change; and • They entail little or no capital costs such as installation cost, commissioning and management of the required infrastructure. The design of soft sensors can be either by utilizing grey or black box identification approaches or on the basis of an analytical model. In the development of data-driven empirical model, least squares regression has been widely used. Nevertheless, when numerous input variables are used, this technique can become ineffective due to the strongly correlated nature of process variables. For instance, distillation column tray temperatures are closely correlated to each other and change together in the same pattern. Using linear regression techniques on such highly correlated process data leads to numerical errors due to close to singularity in the data covariance matrix. The common approach for tackling correlation problems is to select a few appropriate variables which are less correlated from each other [17–19]. However, this simple technique is not optimal because the information in the discarded measurements might enhance the model performance. Brosilow and co-workers [17,18] introduced a composition estimator called the Brosilow Estimator in which flow rates and temperatures were used for predicting unmeasured disturbance and then the estimated disturbances were utilized to predict product compositions. However, in recent years, product composition estimators have been designed using partial least squares regression (PLS) [20,21]. Mejdell and Skogested [22] compared three linear model-based composition estimators of a binary distillation column. They briefed that good control performance might be reached with the steady state PCR (principal component regression) estimator. They found that the performance of the steady state PCR estimator is nearly good as the dynamic Kalman filter. Zhang [23,24] developed an inferential feedback control strategy for binary distillation composition control using PCR and PLS models. In these works, both top and bottom compositions are estimated via multiple tray temperature measurements and the estimated top and bottom product compositions are then used as feedback control signals. 3. a binary distillation column for methanol-water separation The distillation column considered in this paper is a comprehensive nonlinear simulation of a methanol–water separation column which is based on the Wood and Berry’s column at University of Alberta in Canada. The schematic diagram of this distillation column is shown in Figure 2. The column has 10 trays including the re-boiler and the condenser. The feed stream enters the distillation column at the 5th tray. The following assumptions are used in the development of a rigorous mechanistic model: constant liquid holdup, negligible vapor holdup, and perfect mixing in each stage. The nominal operation data for this column are given in Table 1. The nominal set-points of the product compositions in this study are the distillate at 93% and the bottom composition at 7%. A dynamic simulation program is developed in MATLAB based on the mechanistic model. In our previous study [25], we compared product composition control in this distillation column using ADRC and PID control. It is shown that ADRC gives better performance than PID for both setpoint tracking and disturbance rejection. However, the practical difficulty in product composition measurements is not considered in [25] and it is assumed that product composition measurements are available without time delays. Sensors 2023, 23, 1019 6 of 17
Sensors 2023, 23, x FOR PEER REVIEW 6 of 17
data for this column are given in Table 1. The nominal set-points of the product compositions in this study are the distillate at 93% and the bottom composition at 7%. A dynamic simulation program is developed in MATLAB based on the mechanistic model. In our previous study [25], we compared product composition control in this distillation column using ADRC and PID control. It is shown that ADRC gives better performance than PID for both setpoint tracking and disturbance rejection. However, the practical difficulty in product composition measurements is not considered in [25] and it is assumed that product composition measurements are available without time delays. Figure 2. A binary distillation column with tray temperature control scheme. 4. inferential adrc scheme The proposed inferential ADRC scheme for distillation column product composition control is shown in Figure 3. It can be seen from Figure 3 that the top composition (y1) and bottom composition (y2) are taken as the primary controlled variables where the secondary measurements are tray temperatures (x). Moreover, the distillation column is subjected to two different disturbances which are feed flow rate and feed composition disturbances. In this control scheme, both top and bottom compositions are estimated via multiple tray temperature measurements through soft sensors and the estimated product compositions are then used as feedback signals for the composition controllers. The soft sensors are developed using PCR. It should be noted that for highly nonlinear processes, such as batch distillation processes, nonlinear soft sensors should be utilized [26–29]. In
Figure 2. A binary distillation column with tray temperature control scheme. l . i l istill ti c l r ti t . 4. inferential adrc scheme The proposed inferential ADRC scheme for distillation column product composition control is shown in Figure 3. It can be seen from Figure 3 that the top composition (y1) and bottom composition (y2) are taken as the primary controlled variables where the secondary measurements are tray temperatures (x). Moreover, the distillation column is subjected to two different disturbances which are feed flow rate and feed composition disturbances. In this control scheme, both top and bottom compositions are estimated via multiple tray temperature measurements through soft sensors and the estimated product co positions are then used as feedback signals for the composition controllers. The soft sensors are devel ped using PCR. It should be noted that for ighly n nlinear processes, such as batch distillation processes, nonlinear s ft sensors should be utilized [26–29]. In our arlier work [30], static PCR models are used. I th current work, the soft sensors are extended to using dynamic PCR models. Sensors 2023, 23, 1019 7 of 17
Sensors 2023, 23, x FOR PEER REVIEW 7 of 17
our earlier work [30], static PCR models are used. In the current work, the soft sensors are extended to using dynamic PCR models. 5. pcr model-based software sensors In order to develop soft sensors, historical process operational data containing measurements of tray temperatures and product compositions are required. In this study, simulated process operation data are generated covering different operating conditions (with setpoint changes and disturbances). The data set for tray temperature and product composition in a real distillation column can be obtained from historical plant operation. Temperature measurement devices such as thermocouples are cheap and all tray temperatures can be easily monitored. Composition analyzers can be expensive and it might not be economically viable to install dedicated composition analyzers for each distillation column in a plant. In this case, the plant can put on temporary composition analyzers, e.g., hired ones, to a distillation column for the period of modelling campaign for the purpose of data collection. As shown in Table 1, the nominal operating point considered in this paper is that the top composition at 93% and the bottom composition at 7%. Simulated process operational data around this nominal operating are generated. Figure 4 shows the top and bottom product compositions while the corresponding secondary measurements of tray temperatures are shown in Figure 5. It can be seen from Figure 5 that a strong correlation exists among tray temperature measurements. 5. pcr model-based software sensors surements of tray temperatures and product compositions are required. In this study, simulated process operation data are generated covering different operating conditions (with setpoint changes and disturbances). The data set for tray temperature and product composition in a real distillation column can be obtained from historical plant operation. Temperature measurement devices such as thermocouples are cheap and all tray temperatures can be easily monitored. Composition analyzers can be expensive and it might not be economically viable to install dedicated composition analyzers for each distillation column in a plant. In this case, the plant can put on temporary composition analyzers, e.g., hired ones, to a distillation column for the period of modelling campaign for the purpose of data collection. As shown in Table 1, the nominal operating point considered in this paper is that the top composition at 93% and the bottom composition at 7%. Simulated process operational data around this nominal operating are generated. Figure 4 shows the top and bottom pro uct compositions while the corresponding secondary measurements of tray temperatures are shown in Figure 5. It can be see from Figure 5 that strong correlation exists among tray temperature measurements. Sensors 2023, 23, x FOR PEER REVIEW 8 of 17
Figure 4. Top and Bottom product compositions. Figure 5. Tray temperatures. 5.1. static pcr models In the static PCR model based soft sensors, the product compositions at time t are estimated using the tray temperatures at time t. The soft sensors can be presented in the following form: 𝑦(𝑡) = 𝜃 𝑇 (𝑡) + 𝜃 𝑇 (𝑡) + ⋯ + 𝜃 𝑇 (𝑡), (5) where y denotes the estimated product compositions, T1 to T10 represent the tray temperatures from tray 1 to tray 10 respectively, θ1 to θ10 are corresponding model parameters, and t represents the discrete time. Before developing the soft sensors, the data are first scaled to zero mean and unit variance. The complete set of tray temperature and product composition data is divided into two sets: the training data set (samples 1 to 1189) and the testing data set (samples 1190 to 1982). PCR models with various numbers of principal components are developed on the training data and then tested on the testing data. The
Figure 4. Top and Bo tom product co positions. Sensors 2023, 23, 1019 8 of 17
Sensors 2023, 23, x FOR PEER REVIEW 8 of 17
Figure 4. Top and Bottom product compositions. Figure 5. Tray temperatures. 5.1. Static PCR Models In the static PCR model based soft sensors, the product compositions at time t are estimated using the tray temperatures at time t. The soft sensors can be presented in the following form: 𝑦(𝑡) = 𝜃 𝑇 (𝑡) + 𝜃 𝑇 (𝑡) + ⋯ + 𝜃 𝑇 (𝑡), (5) where y denotes the estimated product compositions, T1 to T10 represent the tray temperatures from tray 1 to tray 10 respectively, θ1 to θ10 are corresponding model parameters, and t represents the discrete time. Before developing the soft sensors, the data are first scaled to zero mean and unit variance. The complete set of tray temperature and product composition data is divided into two sets: the training data set (samples 1 to 1189) and the testing data set (samples 1190 to 1982). PCR models with various numbers of principal components are developed on the training data and then tested on the testing data. The
Figure 5. Tray temperatures. 5.1. static pcr models In the static PCR model based soft sensors, the product compositions at time t are estimated using the tray temperatures at time t. The soft sensors can be presented in the following form:
y(t) = θ1T1(t) + θ2T2(t) + · · ·+ θ10T10(t) (5)
where y denotes the estimated product compositions, T1 to T10 represent the tray temperatu s from tray 1 to tray 10 respectively, θ1 to θ10 are corresponding model para eters, and t represents the discrete time. B fore developing the oft se sors, the d t are first scaled to zero mean and unit variance. The complete set of tray temperature and product omposition dat is divided into two sets: the training data set (samples 1 to 1189) and the testing data set (samples 1190 to 1982). PCR models with various numbers of principal component are developed on the training data and then tested o the testing data. The PCR model with th lowest error on the testing data is con idered as having the suitable number of principal components and is taken as the final soft sensor. Table 2 presents the sum of squared errors (SSE) of different PCR models on the training and testing data. It can be seen that the PCR model with six principal components gives the best performance for the top composition on the testing data and 10 principal components offers the best performance for the bottom compositions on the testing data. Therefore, six principal components are used in the top composition model and 10 principal components are used in the bottom composition model. The developed PCR models for top and bottom product compositions are as follows [30]:
yD(t) = 93 + 0.0450∆T1(t)− 0.0357∆T2(t)− 0.1304∆T3(t) + 0.1891∆T4(t)− 0.0345∆T5(t) + 0.0881∆T6(t) −0.3115∆T7(t)− 0.3255∆T8(t)− 0.0666∆T9(t)− 0.6737∆T10(t)
(6)
yB(t) = 7− 0.3944∆T1(t) + 0.0718∆T2(t)− 0.2206∆T3(t) + 1.3567∆T4(t) + 0.2175∆T5(t) + 0.8840∆T6(t) −0.9850∆T7(t)− 0.8758∆T8(t)− 1.7598∆T9(t)− 0.7149∆T10(t)
(7)
where yD and yB represent the top and bottom compositions (wt%) respectively, and ∆T is the deviation of a tray temperature from its nominal mean value. Sensors 2023, 23, 1019 9 of 17
Table 2. SSE on training and testing data for static PCR models with different numbers of principal components. No. of PCs Top Composition Bottom Composition
Training Data Testing Data Training Data Testing Data
1 410.00 230.00 1400 280.30 2 32.00 10.00 679.90 82.27 3 31.00 10.00 89.39 19.71 4 4.00 0.78 68.10 8.50 5 3.50 0.48 49.35 6.71 6 3.15 0.32 40.86 5.45 7 3.14 0.32 35.64 6.43 8 3.07 0.36 27.82 3.36 9 2.93 0.38 20.21 2.66 10 2.85 0.34 17.86 1.94
Figure 6 gives the PCR model predictions. It can be seen from this figure that the model predictions are very accurate, especially for the top product composition. Sensors 2023, 23, x FOR PEER REVIEW 9 of 17 PCR model with the lowest error on the testing data is considered as having the suitable number of principal components and is taken as the final soft sensor. Table 2 presents the sum of squared errors (SSE) of different PCR models on the training and testing data. It can be seen that the PCR model with six principal components gives the best performance for the top composition on the testing data and 10 principal components offers the best performance for the bottom compositions on the testing data. Therefore, six principal components are used in the top composition model and 10 principal components are used in the bottom composition model. The developed PCR models for top and bottom product compositions are as follows [30]: 𝑦 (𝑡) = 93 + 0.0450∆𝑇 (𝑡) − 0.0357∆𝑇 (𝑡) − 0.1304∆𝑇 (𝑡) + 0.1891∆𝑇 (𝑡) − 0.0345∆𝑇 (𝑡) + 0.0881∆𝑇 (𝑡)− 0.3115∆𝑇 (𝑡) − 0.3255∆𝑇 (𝑡) − 0.0666∆𝑇 (𝑡) − 0.6737∆𝑇 (𝑡) (6)𝑦 (𝑡) = 7 − 0.3944∆𝑇 (𝑡) + 0.0718∆𝑇 (𝑡) − 0.2206∆𝑇 (𝑡) + 1.3567∆𝑇 (𝑡) + 0.2175∆𝑇 (𝑡) + 0.8840∆𝑇 (𝑡)− 0.9850∆𝑇 (𝑡) − 0.8758∆𝑇 (𝑡) − 1.7598∆𝑇 (𝑡) − 0.7149∆𝑇 (𝑡) (7) where yD and yB represent the top and bottom compositions (wt%) respectively, and ΔT is the deviation of a tray temperature from its nominal mean value. Table 2. SSE on training and testing data for static PCR models with different numbers of principal components. No. of PCs
Top Composition Bottom Composition
Training Data Testing Data Training Data Testing Data 1 410.00 230.00 1400 280.30 2 32.00 10.00 679.90 82.27 3 31.00 10.00 89.39 19.71 4 4.00 0.78 68.10 8.50  5 3.5 4 49 35 6.71  6 3.15 0.32 40.86 5.45  7 3.14 0.32 35.64 6.43  8 3.07 0.36 27.82 3.36  9 2.93 . 6  10 2.85 0.34 17.86 1.94 Figure 6 gives the PCR odel predictions. It can be seen fro this figure that the odel predictions are very accurate, especially for the top product co position. 5.2. dynamic pcr models The inferential estimation accuracy might be further enhanced and improved if dynamic PCR models are developed. In this paper, dynamic PCR models with orders ranging from one to seven were developed. The first order dynamic PCR models can be represented in the form below:
y(t) = θ1,1T1(t) + θ1,2T1(t− 1) + θ2,1T2(t) + θ2,2T2(t− 1) + · · ·+ θ10,1T10(t) + θ10,2T10(t− 1) (8)
Data partition and data scaling are the same as in developing static PCR models presented earlier. The suitable numbers of principal components were once again specified by the least SSE on the testing data. Table 3 presents the number of principal components and the corresponding SSE values on the testing data of these dynamic PCR models. Sensors 2023, 23, 1019 10 of 17
Table 3. Number of principal components and SSE on testing data of different dynamic PCR models. Model Orders Model Output SSE No. of Principal Components
1 Top composition 0.662 11 Bot composition 13.04 11
2 Top composition 0.361 14 Bot composition 9.958 7
3 Top composition 0.045 32 Bot composition 2.970 7
4 Top composition 0.140 50 Bot composition 2.542 7
5 Top composition 0.122 17 Bot composition 1.323 7
6 Top composition 0.145 42 Bot composition 4.722 8
7 Top composition 0.141 54 Bot composition 3.958 8
It can be seen that the dynamic PCR models significantly enhance the estimation accuracy compared to the static PCR model especially at third order, fourth order, fifth order, and sixth order models. All these four models have been compared, discussed and investigated in terms of SSE values. The differences in SSE values between these four models are not significant. Hence, the fifth order dynamic PCR model is used and integrated with the ADRC scheme to estimate the top and bottom product compositions. The estimations from the 5th order dynamic PCR model are shown in Figure 7. Again, in this figure the solid lines represent the actual measured compositions while the dashed lines represent the corresponding model estimations. Sensors 2023, 23, x FOR PEER REVIEW 11 of 17
Figure 7. Model predictions from the 5th order dynamic PCR model. The model parameters of the 5th order dynamic PCR models are given in Appendix A, where Table A1 gives the model parameters for the top composition and Table A2 gives the model parameters for the bottom composition. Figure 8 presents the estimation errors for both the static and the 5th order dynamic PCR model. It can be seen that the 5th order dynamic PCR model gives better prediction performance than the static model. Figure 8. Model prediction errors. 6. inferential adrc scheme based on pcr models In the product composition control of this distillation column, the manipulated variables for top and bottom compositions are reflux flow rate (L) and steam flow rate (V) to the reboiler, respectively. The secondary measurements, which are tray temperature measurements, are fed to the PCR soft sensors to estimate the top and bottom product compositions. Then, the estimations are used in feedback control to the ADRC controller, as shown in Figure 9. The performance of both ADRC and inferential control was investigated through simulation. The following disturbances in the form of step changes were applied to the simulated column: the feed composition was increased by 15% at the 600th minutes and the feed flow rate was increased by 15% at the 1200th minutes. Moreover, series setpoints changes were applied to both top and bottom product compositions. Figure 7. Model predictions from the 5th order dynamic PCR model. It can be seen that the dynamic PCR models significantly improve the estimation accuracy compared to the static PCR model especially at the 3rd to 6th order models. All these four models have been compared, discussed and investigated in terms of SSE values. The differences in SSE values between these four models are not significant. Hence, the 5th order dynamic PCR model is used and integrated with the ADRC scheme to control the top and bottom compositions. The estimations from the 5th order dynamic PCR model are shown in Figure 7. Again, in this figure the solid lines represent the actual measured compositions while the dashed lines represent the corresponding model estimations. Sensors 2023, 23, 1019 11 of 17
The model parameters of the 5th order dynamic PCR models are given in Appendix A, where Table A1 gives the model parameters for the top composition and Table A2 gives the model parameters for the bottom composition. Figure 8 presents the estimation errors for both the static and the 5th order dynamic PCR model. It can be seen that the 5th order dynamic PCR model gives better prediction performance than the static model. Sensors 2023, 23, x FOR PEER REVIEW 11 of 17
Figure 7. Model predictions from the 5th order dynamic PCR model. The odel r er yna ic PCR models are given in A pendix A, wh re Table A1 gives the model parameters for the t l 2 gives the model parameters for the bot om composition. Figure 8 presents the estimation er ors for both the static and the 5th order dynamic PCR model. It can be se n that the 5th order dynamic PCR model gives bet er prediction perfor ance than t e static el. Figure 8. Model prediction errors. 6. Inferential ADRC Scheme Based on PCR Models In the product composition control of this distillation column, the manipulated variables for top and bottom compositions are reflux flow rate (L) and steam flow rate (V) to the reboiler, respectively. The secondary measurements, which are tray temperature measurements, are fed to the PCR soft sensors to estimate the top and bottom product compositions. Then, the estimations are used in feedback control to the ADRC controller, as shown in Figure 9. The performance of both ADRC and inferential control was investigated through simulation. The following disturbances in the form of step changes were applied to the simulated column: the feed composition was increased by 15% at the 600th minutes and the feed flow rate was increased by 15% at the 1200th minutes. Moreover, series setpoints changes were applied to both top and bottom product compositions. Figure 8. Model prediction errors. 6. inferential adrc scheme based on pcr models In the product composition control of this distillation column, the manipulated variables for top and bottom compositions are reflux flow rate (L) and steam flow rate (V) to the reboiler, respectively. The secondary measurements, which are tray temperature measurements, are fed to the PCR soft sensors to estimate the top and bottom product compositions. Then, the estimations are used in feedback control to the ADRC controller, as shown in Figure 9. The performance of both ADRC and inferential control was investigated through simulation. The following disturbances in the form of step changes were applied to the simulated column: the feed composition was increased by 15% at the 600th minutes and the feed flow rate was increased by 15% at the 1200th minutes. Moreover, series setpoints changes were applied to both top and bottom product compositions. Sensors 2023, 23, x FOR PEER REVIEW 12 of 17
Figure 9. Inferential ADRC control of product compositions. The inferential ADRC control strategy is compared with single tray temperature control and composition analyzer-based control. Through investigating the data presented in Figures 4 and 5, it was found that the temperature of the 8th tray (from the bottom column) has the largest correlation coefficient with the top product composition and the temperature of the 2nd tray has the largest correlation coefficient with the bottom product composition. Hence, temperatures of the 2nd and the 8th trays were controlled to indirectly control the bottom and top product compositions respectively. Temperatures at the 2nd and the 8th trays corresponding to the top composition of 93% and the bottom composition of 7% are 85.9 °C and 70.5 °C, respectively. Hence, the setpoints for the 2nd and the 8th tray temperatures were set at 85.9 °C and 70.5 °C, respectively. Temperature setpoints corresponding to other product compositions were identified from simulated process operation data. In the product composition analyzer-based composition control, a 10 min measurement delay was assumed. For both cases, multi-loop PI controllers were used. Figure 10 shows the control performance of tray temperature control and composition analyzer-based control. The solid, dash-dotted, and dashed lines represent the response of the single tray temperature control, composition analyzer-based control, and the desired set-point signal. It can be seen from this figure that composition analyzerbased control has sluggish response and due to the large measurement delay, the controller has been significantly de-tuned to ensure stability. In the tray temperature control scheme, significant static control offsets exist in both product compositions especially the bottom product composition. This is due to the fact that the relationship between the single tray temperature and product compositions can be significantly affected by the variation of process operating condition such as setpoint changes and the presence of disturbances. Sensors 2023, 23, 1019 12 of 17
The inferential ADRC control strategy is compared with single tray temperature control and composition analyzer-based control. Through investigating the data presented in Figures 4 and 5, it was found that the temperature of the 8th tray (from the bottom column) has the largest correlation coefficient with the top product composition and the temperature of the 2nd tray has the largest correlation coefficient with the bottom product composition. Hence, temperatures of the 2nd and the 8th trays were controlled to indirectly control the bottom and top product compositions respectively. Temperatures at the 2nd and the 8th trays corresponding to the top composition of 93% and the bottom composition of 7% are 85.9 ◦C and 70.5 ◦C, respectively. Hence, the setpoints for the 2nd and the 8th tray temperatures were set at 85.9 ◦C and 70.5 ◦C, respectively. Temperature setpoints corresponding to other product compositions were identified from simulated process operation data. In the product composition analyzer-based composition control, a 10 min measurement delay was assumed. For both cases, multi-loop PI controllers were used. Figure 10 shows the control performance of tray temperature control and composition analyzer-based control. The solid, dash-dotted, and dashed lines represent the response of the single tray temperature control, composition analyzer-based control, and the desired set-point signal. It can be seen from this figure that composition analyzer-based control has sluggish response and due to the large measurement delay, the controller has been significantly de-tuned to ensure stability. In the tray temperature control scheme, significant static control offsets exist in both product compositions especially the bottom product composition. This is due to the fact that the relationship between the single tray temperature and product compositions can be significantly affected by the variation of process operating condition such as setpoint changes and the presence of disturbances. Sensors 2023, 23, x FOR PEER REVIEW 13 of 17
Figure 11 shows the setpoint tracking and disturbance rejection performance of inferential ADRC with static PCR model across a broad range of setpoint changes, feed flow rate and feed composition disturbances. The setpoint signal was smoothed by TPG to avoid the undesired overshoot. It can be seen that the top composition is controlled quite well with small static control offsets, but large static control errors exist for the bottom product composition. The static control errors are due to the errors of the PCR models which can get worse when operating condition changes such setpoint change and/or disturbance changes. Figure 12 shows the setpoint tracking and disturbance rejection performance of inferential ADRC with the 5th order dynamic PCR model for the same setpoint changes, feed flow rate and feed composition disturbances, as shown in Figure 11. It can be seen the control performance improved under the dynamic PCR model. However, static control offsets still exist. Figure 11. Responses of actual and estimated product compositions under inferential ADRC with static PCR model (without mean updating). Figure 11 shows the setpoint tracking and disturbance rejection performance of inferential ADRC with static PCR model across a broad range of setpoint changes, feed flow rate and feed composition disturbances. The setpoint signal was smoothed by TPG to avoid the undesired overshoot. It can be seen that the top composition is controlled quite well with small static control offsets, but large static control errors exist for the bottom product composition. The static control errors are due to the errors of the PCR models which can get worse when operating condition changes such setpoint change and/or disturbance changes. Figure 12 shows the setpoint tracking and disturbance rejection performance of inferential ADRC with the 5th order dynamic PCR model for the same setpoint changes, feed flow rate and feed composition disturbances, as shown in Figure 11. It can be seen
Sensors 2023, 23, 1019 13 of 17
the control performance improved under the dynamic PCR model. However, static control offsets still exist. Sensors 2023, 23, x FOR PEER REVIEW 13 of 17 Figure 10. Control performance of tray temperature control and composition analyzer-based control. Figure 11 shows the setpoint tracking and disturbance rejection performance of inferential ADRC with static PCR model across a broad range of setpoint changes, feed flow rate and feed composition disturbances. The setpoint signal was smoothed by TPG to avoid the undesired overshoot. It can be seen that the top composition is controlled quite well with small static control offsets, but large static control errors exist for the bottom product composition. The static control errors are due to the errors of the PCR models which can get worse when operating condition changes such setpoint change and/or disturbance changes. Figure 12 shows the setpoint tracking and disturbance rejection perf rmance of inferential ADRC with the 5th order dynamic PCR model for the same setpoint changes, feed flow rate and feed composition disturbances, as shown in Figure 11. It can be seen the control performance improved under the dynamic PCR model. However, static control offsets still exist. Figure 11. Responses of actual and estimated product compositions under inferential ADRC with static PCR model (without mean updating). Figure 11. Responses of actual and estimated product compositions under inferential ADRC with static PCR model (without mean updating). Sensors 2023, 23, x FOR PEER REVIEW 14 of 17
Figure 12. Responses of actual and estimated product compositions under inferential ADRC with 5th order dynamic PCR models (without mean updating). To overcome the static control offset issue due to the variation in process operating conditions, the intermittent process variable mean updating strategy proposed by Zhang [24] is used here. When a new steady state is reached, the static values of product compositions and tray temperatures are used to replace the current mean values of these variables in the PCR models. It can be seen here that only intermittent product composition measurements are required. Figures 13 and 14 present the control performance with mean updating technique. It can be noticed from these figures that the mean updating technique is an efficient technique for significantly reducing the static control offsets. Moreover, the SSE of control errors has been reduced dramatically after using the mean updating technique, as shown in Table 4. Figure 13. Responses of actual and estimated product compositions of static inferential ADRC (with mean updating). Figure 12. Responses of actual and estimated product compositions under inferential ADRC with 5th order dynamic PCR models (without mean updating). To overcome the static control offset issue due to the variation in process operating conditions, the intermittent process variable mean updating strategy proposed by Zhang [24] is used here. When a new steady state is reached, the static values of product compositions and tray temperatures are used to replace the current mean values of these variables in the PCR models. It can be seen here that only intermittent product composition measurements are required. Figures 13 and 14 present the control performance with mean updating technique. It can be noticed from these figures that the mean updating technique is an efficient technique for significantly reducing the static control offsets. Moreover, the SSE of control errors has been reduced dramatically after using the mean updating technique, as shown in Table 4. Sensors 2023, 23, 1019 14 of 17
Sensors 2023, 23, x FOR PEER REVIEW 14 of 17 Figure 12. Responses of actual and estimated product compositions under inferential ADRC with 5th order dynamic PCR models (without mean updating). To overcome the static control offset issue due to the variation in process operating conditions, the intermittent process variable mean updating strategy proposed by Zhang [24] is used here. When a new steady state is reached, the static values of product compositions and tray temperatures are used to replace the current mean values of these variables in the PCR models. It can be seen here that only intermittent product composition measurements are required. Figures 13 and 14 present the control performance with mean updating technique. It can be noticed from these figures that the mean updating technique is an efficient technique for significantly reducing the static control offsets. Moreover, the SSE of control errors has been reduced dramatically after using the mean updating technique, as shown in Table 4. Figure 13. Responses of actual and estimated product compositions of static inferential ADRC (with mean updating). Figure 13. Responses of actual and estimated product compositions of static inferential ADRC (with mean updating). Sensors 2023, 23, x FOR PEER REVIEW 15 of 17
Figure 14. Responses of actual and estimated product compositions under inferential ADRC with 5th order dynamic PCR models (with mean updating). Table 4. SSE of different control schemes. Control Schemes Top Comp. Bottom Comp. Inferential ADRC with
static PCR model Without mean updating 54,542 6946.9
With mean updating 1.6889 1.8309 Inferential ADRC with 5th order dynamic PCR model Without mean updating 165.52 219.59 With mean updating 0.1856 0.1551
It can be seen from Figures 13 and 14 that the resulting control off-sets and steady state model estimation bias have been eliminated successfully through the mean updating technique. Moreover, it can be noticed from Table 4 that the dynamic PCR model has much smaller estimation off-sets than the static PCR model when the operating condition changed. This leads to a result that the dynamic PCR model is more robust than the static PCR model to process operating condition variations. As a result, the dynamic inferential ADRC scheme gives better control performance than the static inferential ADRC. 7. conclusions Inferential ADRC control schemes with static and dynamic PCR models are proposed for product composition control in distillation columns. Inferential estimation models for product compositions are developed from process operational data using PCR. The estimated product compositions are used as the controlled variables in the ADRC controller. Mean updating technique is used to eliminate the steady state model estimation bias and the resulting control off-sets. The proposed control method is applied to a simulated methanol–water separation column. Simulation results indicate the effectiveness and success of the proposed dynamic inferential ADRC control method over the static inferential ADRC control method. Author Contributions: Conceptualization, F.A.K. and J.Z. ; methodology, F.A.K. and J.Z. ; software, F.A.K. and J.Z. ; validation, F.A.K. ; formal analysis, F.A.K. ; investigation, F.A.K. ; resources, J.Z. ; data curation, F.A.K. and J.Z. ; writing—original draft preparation, F.A.K. ; writing—review and editing, J.Z. ; visualization, F.A.K. ; supervision, J.Z. ; project administration, J.Z. All authors have read and agreed to the published version of the manuscript. Figure 14. Responses of actual and estimated product compositions under inferential ADRC with 5th order dynamic PCR models (with mean updating). Table 4. SSE of different control sche es. Control Schemes Comp. Botto p.
Inferential ADRC with static PCR model
Without mean ting ,542 6
With mean updating 1.6889 1.8309
Inferential ADRC with 5th order dynamic PCR model
Without mean updating 165.52 219.59
With mean updating 0.1856 0.1551
It can be seen from Figures 13 and 14 that the resulting control off-sets and steady state model estimation bias have been eliminated successfully through the mean updating technique. Moreover, it can be noticed from Table 4 that the dynamic PCR model has
Sensors 2023, 23, 1019 15 of 17
much smaller estimation off-sets than the static PCR model when the operating condition changed. This leads to a result that the dynamic PCR model is more robust than the static PCR model to process operating condition variations. As a result, the dynamic inferential ADRC scheme gives better control performance than the static inferential ADRC. 7. conclusions Inferential ADRC control schemes with static and dynamic PCR models are proposed for product composition control in distillation columns. Inferential estimation models for product compositions are developed from process operational data using PCR. The estimated product compositions are used as the controlled variables in the ADRC controller. Mean updating technique is used to eliminate the steady state model estimation bias and the resulting control off-sets. The proposed control method is applied to a simulated methanol– water separation column. Simulation results indicate the effectiveness and success of the proposed dynamic inferential ADRC control method over the static inferential ADRC control method. Author Contributions: Conceptualization, F.A.K. and J.Z. ; methodology, F.A.K. and J.Z. ; software, F.A.K. and J.Z. ; validation, F.A.K. ; formal analysis, F.A.K. ; investigation, F.A.K. ; resources, J.Z. ; data curation, F.A.K. and J.Z. ; writing—original draft preparation, F.A.K. ; writing—review and editing, J.Z. ; visualization, F.A.K. ; supervision, J.Z. ; project administration, J.Z. All authors have read and agreed to the published version of the manuscript. Funding: This research was funded by Petroleum Development of Oman (PDO) and the EU FP7 (Ref: PIRSES-GA-2013-612230). Institutional Review Board Statement: Not applicable. Informed Consent Statement: Not applicable. Data Availability Statement: Not applicable. Conflicts of Interest: The authors declare no conflict of interest. appendix a Model parameters of the 5th order dynamic PCR models are given in Table A1 (for top composition) and Table A2 (for bottom composition). Table A1. Model parameters for top composition. t t − 1 t − 2 t − 3 t − 4 t − 5 T1 −0.037 0.006 0.077 0.091 0.039 −0.151 T2 0.012 −0.039 −0.030 −0.061 0.031 −0.001 T3 0.115 0.059 0.031 −0.021 −0.002 −0.030 T4 0.051 0.014 −0.003 −0.035 −0.009 −0.020 T5 0.046 −0.022 −0.021 −0.044 −0.052 −0.016 T6 −0.083 −0.045 0.056 0.068 0.065 0.016 T7 −0.138 −0.069 0.020 0.044 0.071 0.055 T8 −0.171 −0.110 −0.042 −0.023 0.004 0.007 T9 −0.175 −0.103 −0.015 0.013 0.068 0.100 T10 −0.219 −0.146 −0.088 −0.071 −0.047 −0.017
Sensors 2023, 23, 1019 16 of 17
Table A2. Model parameters for bottom composition. t t − 1 t − 2 t − 3 t − 4 t − 5 T1 −0.569 −0.453 −0.307 −0.140 0.032 0.191 T2 −0.122 −0.084 −0.037 0.042 0.154 0.261 T3 0.056 0.052 0.047 0.060 0.100 0.142 T4 0.019 −0.004 −0.041 −0.076 −0.093 −0.097 T5 0.083 0.059 0.020 −0.033 −0.084 −0.122 T6 0.113 0.065 0.016 −0.028 −0.005 −0.062 T7 0.002 −0.027 −0.047 −0.053 −0.041 −0.015 T8 0.032 0.014 0.004 0.007 0.026 0.055 T9 −0.008 −0.033 −0.048 −0.048 −0.027 0.008 T10 0.017 0.001 −0.004 0.003 0.028 0.067